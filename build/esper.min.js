!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.esper=t()}}(function(){var t;return function e(t,i,r){function n(s,o){if(!i[s]){if(!t[s]){var h="function"==typeof require&&require;if(!o&&h)return h(s,!0);if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=i[s]={exports:{}};t[s][0].call(d.exports,function(e){var i=t[s][1][e];return n(i?i:e)},d,d.exports,e,t,i,r)}return i[s].exports}for(var a="function"==typeof require&&require,s=0;s<r.length;s++)n(r[s]);return n}({1:[function(t,e){!function(){"use strict";e.exports={CubeMapRenderTarget:t("./core/CubeMapRenderTarget"),RenderTarget:t("./core/RenderTarget"),Shader:t("./core/Shader"),Texture2D:t("./core/Texture2D"),TextureCubeMap:t("./core/TextureCubeMap"),VertexBuffer:t("./core/VertexBuffer"),VertexPackage:t("./core/VertexPackage"),IndexBuffer:t("./core/IndexBuffer"),Viewport:t("./core/Viewport"),WebGLContext:t("./core/WebGLContext"),Camera:t("./render/Camera"),Entity:t("./render/Entity"),Geometry:t("./render/Geometry"),Material:t("./render/Material"),Mesh:t("./render/Mesh"),Joint:t("./render/Joint"),Octree:t("./render/Octree"),Renderable:t("./render/Renderable"),Renderer:t("./render/Renderer"),RenderPass:t("./render/RenderPass"),RenderTechnique:t("./render/RenderTechnique"),Skeleton:t("./render/Skeleton"),Cube:t("./util/shapes/Cube"),Cylinder:t("./util/shapes/Cylinder"),Quad:t("./util/shapes/Quad"),ShapeUtil:t("./util/shapes/ShapeUtil"),Sphere:t("./util/shapes/Sphere"),glTFLoader:t("./util/gltf/glTFLoader"),OBJMTLLoader:t("./util/obj/OBJMTLLoader"),Util:t("./util/Util"),Debug:t("./util/debug/Debug"),Mat33:t("alfador").Mat33,Mat44:t("alfador").Mat44,Vec2:t("alfador").Vec2,Vec3:t("alfador").Vec3,Vec4:t("alfador").Vec4,Quaternion:t("alfador").Quaternion,Transform:t("alfador").Transform,Triangle:t("alfador").Triangle}}()},{"./core/CubeMapRenderTarget":14,"./core/IndexBuffer":15,"./core/RenderTarget":16,"./core/Shader":17,"./core/Texture2D":19,"./core/TextureCubeMap":20,"./core/VertexBuffer":21,"./core/VertexPackage":22,"./core/Viewport":23,"./core/WebGLContext":24,"./render/Camera":26,"./render/Entity":27,"./render/Geometry":28,"./render/Joint":29,"./render/Material":30,"./render/Mesh":31,"./render/Octree":32,"./render/RenderPass":33,"./render/RenderTechnique":34,"./render/Renderable":35,"./render/Renderer":36,"./render/Skeleton":37,"./util/Util":39,"./util/debug/Debug":41,"./util/gltf/glTFLoader":43,"./util/obj/OBJMTLLoader":51,"./util/shapes/Cube":52,"./util/shapes/Cylinder":53,"./util/shapes/Quad":54,"./util/shapes/ShapeUtil":55,"./util/shapes/Sphere":56,alfador:10}],2:[function(t,e){!function(){"use strict";function i(t){if(!t)return i.identity();if(t.data instanceof Array)this.data=9===t.data.length?t.data.slice(0):[t.data[0],t.data[1],t.data[2],t.data[4],t.data[5],t.data[6],t.data[8],t.data[9],t.data[10]];else{if(9!==t.length)return i.identity();this.data=Array.prototype.slice.call(t)}}{var r=t("./Vec3");t("./Vec4")}i.prototype.row=function(t){return new r(this.data[0+t],this.data[3+t],this.data[6+t])},i.prototype.col=function(t){return new r(this.data[0+3*t],this.data[1+3*t],this.data[2+3*t])},i.identity=function(){return new i([1,0,0,0,1,0,0,0,1])},i.scale=function(t){return new i("number"==typeof t?[t,0,0,0,t,0,0,0,t]:t instanceof Array?[t[0],0,0,0,t[1],0,0,0,t[2]]:[t.x,0,0,0,t.y,0,0,0,t.z])},i.rotationDegrees=function(t,e){return this.rotationRadians(t*Math.PI/180,e)},i.rotationRadians=function(t,e){if(e instanceof Array&&(e=new r(e)),0===e.lengthSquared())return this.identity();var n=e.normalize(),a=n.x,s=n.y,o=n.z,h=t>0?t%(2*Math.PI):t%(-2*Math.PI),u=Math.sin(h),d=Math.cos(h),f=a*a,c=s*s,l=o*o,p=a*s,y=s*o,m=o*a,g=a*u,x=s*u,v=o*u,w=1-d;return new i([w*f+d,w*p+v,w*m-x,w*p-v,w*c+d,w*y+g,w*m+x,w*y-g,w*l+d])},i.rotationFromTo=function(t,e){var n,a,s,o,h,u,d,f,c,l,p,y=1e-6,m=new r(t).normalize(),g=new r(e).normalize(),x=m.dot(g),v=Math.abs(x),w=new i;return v>1-y?(o=Math.abs(m.x),h=Math.abs(m.y),u=Math.abs(m.z),n=h>o?u>o?new r(1,0,0):new r(0,0,1):u>h?new r(0,1,0):new r(0,0,1),a=n.sub(m),s=n.sub(g),c=2/a.dot(a),l=2/s.dot(s),p=c*l*a.dot(s),w.data[0]=-c*a.x*a.x-l*s.x*s.x+p*s.x*a.x,w.data[3]=-c*a.x*a.y-l*s.x*s.y+p*s.x*a.y,w.data[6]=-c*a.x*a.z-l*s.x*s.z+p*s.x*a.z,w.data[1]=-c*a.y*a.x-l*s.y*s.x+p*s.y*a.x,w.data[4]=-c*a.y*a.y-l*s.y*s.y+p*s.y*a.y,w.data[7]=-c*a.y*a.z-l*s.y*s.z+p*s.y*a.z,w.data[2]=-c*a.z*a.x-l*s.z*s.x+p*s.z*a.x,w.data[5]=-c*a.z*a.y-l*s.z*s.y+p*s.z*a.y,w.data[8]=-c*a.z*a.z-l*s.z*s.z+p*s.z*a.z,w.data[0]+=1,w.data[4]+=1,w.data[8]+=1):(s=m.cross(g),a=1/(1+x),d=a*s.x,f=a*s.z,c=d*s.y,l=d*s.z,p=f*s.y,w.data[0]=x+d*s.x,w.data[3]=c-s.z,w.data[6]=l+s.y,w.data[1]=c+s.z,w.data[4]=x+a*s.y*s.y,w.data[7]=p-s.x,w.data[2]=l-s.y,w.data[5]=p+s.x,w.data[8]=x+f*s.z),w},i.prototype.add=function(t){var e,r=new i(t);for(e=0;9>e;e++)r.data[e]+=this.data[e];return r},i.prototype.sub=function(t){var e,r=new i(t);for(e=0;9>e;e++)r.data[e]=this.data[e]-r.data[e];return r},i.prototype.multVector=function(t){return t=t instanceof Array?new r(t):t,new r({x:this.data[0]*t.x+this.data[3]*t.y+this.data[6]*t.z,y:this.data[1]*t.x+this.data[4]*t.y+this.data[7]*t.z,z:this.data[2]*t.x+this.data[5]*t.y+this.data[8]*t.z})},i.prototype.multScalar=function(t){var e,r=new i;for(e=0;9>e;e++)r.data[e]=this.data[e]*t;return r},i.prototype.multMatrix=function(t){var e,r=new i;for((t.data&&16===t.data.length||t instanceof Array)&&(t=new i(t)),e=0;3>e;e++)r.data[e]=this.data[e]*t.data[0]+this.data[e+3]*t.data[1]+this.data[e+6]*t.data[2],r.data[e+3]=this.data[e]*t.data[3]+this.data[e+3]*t.data[4]+this.data[e+6]*t.data[5],r.data[e+6]=this.data[e]*t.data[6]+this.data[e+3]*t.data[7]+this.data[e+6]*t.data[8];return r},i.prototype.mult=function(t){return"number"==typeof t?this.multScalar(t):t instanceof Array?3===t.length||4===t.length?this.multVector(t):this.multMatrix(t):void 0!==t.x&&void 0!==t.y&&void 0!==t.z?this.multVector(t):this.multMatrix(t)},i.prototype.div=function(t){var e,r=new i;for(e=0;9>e;e++)r.data[e]=this.data[e]/t;return r},i.prototype.equals=function(t,e){var i;for(e=void 0===e?0:e,i=0;9>i;i++)if(!(this.data[i]===t.data[i]||Math.abs(this.data[i]-t.data[i])<=e))return!1;return!0},i.prototype.transpose=function(){var t,e=new i;for(t=0;3>t;t++)e.data[3*t]=this.data[t],e.data[3*t+1]=this.data[t+3],e.data[3*t+2]=this.data[t+6];return e},i.prototype.inverse=function(){var t,e=new i;return e.data[0]=this.data[4]*this.data[8]-this.data[7]*this.data[5],e.data[3]=-this.data[3]*this.data[8]+this.data[6]*this.data[5],e.data[6]=this.data[3]*this.data[7]-this.data[6]*this.data[4],e.data[1]=-this.data[1]*this.data[8]+this.data[7]*this.data[2],e.data[4]=this.data[0]*this.data[8]-this.data[6]*this.data[2],e.data[7]=-this.data[0]*this.data[7]+this.data[6]*this.data[1],e.data[2]=this.data[1]*this.data[5]-this.data[4]*this.data[2],e.data[5]=-this.data[0]*this.data[5]+this.data[3]*this.data[2],e.data[8]=this.data[0]*this.data[4]-this.data[3]*this.data[1],t=this.data[0]*e.data[0]+this.data[1]*e.data[3]+this.data[2]*e.data[6],e.mult(1/t)},i.prototype.decompose=function(){var t=this.col(0),e=this.col(1),i=this.col(2);return{left:t.normalize(),up:e.normalize(),forward:i.normalize(),scale:new r(t.length(),e.length(),i.length())}},i.random=function(){var t=i.rotationRadians(360*Math.random(),r.random()),e=i.scale(10*Math.random());return t.mult(e)},i.prototype.toString=function(){return this.data[0]+", "+this.data[3]+", "+this.data[6]+",\n"+this.data[1]+", "+this.data[4]+", "+this.data[7]+",\n"+this.data[2]+", "+this.data[5]+", "+this.data[8]},i.prototype.toArray=function(){return this.data.slice(0)},e.exports=i}()},{"./Vec3":8,"./Vec4":9}],3:[function(t,e){!function(){"use strict";function i(t){if(!t)return i.identity();if(t.data instanceof Array)this.data=16===t.data.length?t.data.slice(0):[t.data[0],t.data[1],t.data[2],0,t.data[3],t.data[4],t.data[5],0,t.data[6],t.data[7],t.data[8],0,0,0,0,1];else{if(16!==t.length)return i.identity();this.data=Array.prototype.slice.call(t)}}var r=t("./Vec3"),n=t("./Vec4"),a=t("./Mat33");i.prototype.row=function(t){return new n(this.data[0+t],this.data[4+t],this.data[8+t],this.data[12+t])},i.prototype.col=function(t){return new n(this.data[0+4*t],this.data[1+4*t],this.data[2+4*t],this.data[3+4*t])},i.identity=function(){return new i([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])},i.scale=function(t){return new i("number"==typeof t?[t,0,0,0,0,t,0,0,0,0,t,0,0,0,0,1]:t instanceof Array?[t[0],0,0,0,0,t[1],0,0,0,0,t[2],0,0,0,0,1]:[t.x,0,0,0,0,t.y,0,0,0,0,t.z,0,0,0,0,1])},i.translation=function(t){return new i(t instanceof Array?[1,0,0,0,0,1,0,0,0,0,1,0,t[0],t[1],t[2],1]:[1,0,0,0,0,1,0,0,0,0,1,0,t.x,t.y,t.z,1])},i.rotationDegrees=function(t,e){return new i(a.rotationDegrees(t,e))},i.rotationRadians=function(t,e){return new i(a.rotationRadians(t,e))},i.rotationFromTo=function(t,e){return new i(a.rotationFromTo(t,e))},i.prototype.add=function(t){var e,r=new i(t);for(e=0;16>e;e++)r.data[e]+=this.data[e];return r},i.prototype.sub=function(t){var e,r=new i(t);for(e=0;16>e;e++)r.data[e]=this.data[e]-r.data[e];return r},i.prototype.multVector3=function(t){return t=t instanceof Array?new r(t):t,new r({x:this.data[0]*t.x+this.data[4]*t.y+this.data[8]*t.z+this.data[12],y:this.data[1]*t.x+this.data[5]*t.y+this.data[9]*t.z+this.data[13],z:this.data[2]*t.x+this.data[6]*t.y+this.data[10]*t.z+this.data[14]})},i.prototype.multVector4=function(t){return t=t instanceof Array?new n(t):t,new n({x:this.data[0]*t.x+this.data[4]*t.y+this.data[8]*t.z+this.data[12]*t.w,y:this.data[1]*t.x+this.data[5]*t.y+this.data[9]*t.z+this.data[13]*t.w,z:this.data[2]*t.x+this.data[6]*t.y+this.data[10]*t.z+this.data[14]*t.w,w:this.data[3]*t.x+this.data[7]*t.y+this.data[11]*t.z+this.data[15]*t.w})},i.prototype.multScalar=function(t){var e,r=new i;for(e=0;16>e;e++)r.data[e]=this.data[e]*t;return r},i.prototype.multMatrix=function(t){var e,r=new i;for((t.data&&9===t.data.length||t instanceof Array)&&(t=new i(t)),e=0;4>e;e++)r.data[e]=this.data[e]*t.data[0]+this.data[e+4]*t.data[1]+this.data[e+8]*t.data[2]+this.data[e+12]*t.data[3],r.data[e+4]=this.data[e]*t.data[4]+this.data[e+4]*t.data[5]+this.data[e+8]*t.data[6]+this.data[e+12]*t.data[7],r.data[e+8]=this.data[e]*t.data[8]+this.data[e+4]*t.data[9]+this.data[e+8]*t.data[10]+this.data[e+12]*t.data[11],r.data[e+12]=this.data[e]*t.data[12]+this.data[e+4]*t.data[13]+this.data[e+8]*t.data[14]+this.data[e+12]*t.data[15];return r},i.prototype.mult=function(t){return"number"==typeof t?this.multScalar(t):t instanceof Array?3===t.length?this.multVector3(t):4===t.length?this.multVector4(t):this.multMatrix(t):void 0!==t.x&&void 0!==t.y&&void 0!==t.z?void 0!==t.w?this.multVector4(t):this.multVector3(t):this.multMatrix(t)},i.prototype.div=function(t){var e,r=new i;for(e=0;16>e;e++)r.data[e]=this.data[e]/t;return r},i.prototype.equals=function(t,e){var i;for(e=void 0===e?0:e,i=0;16>i;i++)if(!(this.data[i]===t.data[i]||Math.abs(this.data[i]-t.data[i])<=e))return!1;return!0},i.ortho=function(t,e,r,n,a,s){var o=i.identity();return o.data[0]=2/(e-t),o.data[5]=2/(n-r),o.data[10]=-2/(s-a),o.data[12]=-((e+t)/(e-t)),o.data[13]=-((n+r)/(n-r)),o.data[14]=-((s+a)/(s-a)),o},i.perspective=function(t,e,r,n){var a=r*Math.tan(t*(Math.PI/360)),s=-a,o=s*e,h=-o,u=i.identity();return u.data[0]=2*r/(h-o),u.data[5]=2*r/(a-s),u.data[8]=(h+o)/(h-o),u.data[9]=(a+s)/(a-s),u.data[10]=-((n+r)/(n-r)),u.data[11]=-1,u.data[14]=-(2*n*r/(n-r)),u.data[15]=0,u},i.prototype.transpose=function(){var t,e=new i;for(t=0;4>t;t++)e.data[4*t]=this.data[t],e.data[4*t+1]=this.data[t+4],e.data[4*t+2]=this.data[t+8],e.data[4*t+3]=this.data[t+12];return e},i.prototype.inverse=function(){var t,e=new i;return e.data[0]=this.data[5]*this.data[10]*this.data[15]-this.data[5]*this.data[11]*this.data[14]-this.data[9]*this.data[6]*this.data[15]+this.data[9]*this.data[7]*this.data[14]+this.data[13]*this.data[6]*this.data[11]-this.data[13]*this.data[7]*this.data[10],e.data[4]=-this.data[4]*this.data[10]*this.data[15]+this.data[4]*this.data[11]*this.data[14]+this.data[8]*this.data[6]*this.data[15]-this.data[8]*this.data[7]*this.data[14]-this.data[12]*this.data[6]*this.data[11]+this.data[12]*this.data[7]*this.data[10],e.data[8]=this.data[4]*this.data[9]*this.data[15]-this.data[4]*this.data[11]*this.data[13]-this.data[8]*this.data[5]*this.data[15]+this.data[8]*this.data[7]*this.data[13]+this.data[12]*this.data[5]*this.data[11]-this.data[12]*this.data[7]*this.data[9],e.data[12]=-this.data[4]*this.data[9]*this.data[14]+this.data[4]*this.data[10]*this.data[13]+this.data[8]*this.data[5]*this.data[14]-this.data[8]*this.data[6]*this.data[13]-this.data[12]*this.data[5]*this.data[10]+this.data[12]*this.data[6]*this.data[9],e.data[1]=-this.data[1]*this.data[10]*this.data[15]+this.data[1]*this.data[11]*this.data[14]+this.data[9]*this.data[2]*this.data[15]-this.data[9]*this.data[3]*this.data[14]-this.data[13]*this.data[2]*this.data[11]+this.data[13]*this.data[3]*this.data[10],e.data[5]=this.data[0]*this.data[10]*this.data[15]-this.data[0]*this.data[11]*this.data[14]-this.data[8]*this.data[2]*this.data[15]+this.data[8]*this.data[3]*this.data[14]+this.data[12]*this.data[2]*this.data[11]-this.data[12]*this.data[3]*this.data[10],e.data[9]=-this.data[0]*this.data[9]*this.data[15]+this.data[0]*this.data[11]*this.data[13]+this.data[8]*this.data[1]*this.data[15]-this.data[8]*this.data[3]*this.data[13]-this.data[12]*this.data[1]*this.data[11]+this.data[12]*this.data[3]*this.data[9],e.data[13]=this.data[0]*this.data[9]*this.data[14]-this.data[0]*this.data[10]*this.data[13]-this.data[8]*this.data[1]*this.data[14]+this.data[8]*this.data[2]*this.data[13]+this.data[12]*this.data[1]*this.data[10]-this.data[12]*this.data[2]*this.data[9],e.data[2]=this.data[1]*this.data[6]*this.data[15]-this.data[1]*this.data[7]*this.data[14]-this.data[5]*this.data[2]*this.data[15]+this.data[5]*this.data[3]*this.data[14]+this.data[13]*this.data[2]*this.data[7]-this.data[13]*this.data[3]*this.data[6],e.data[6]=-this.data[0]*this.data[6]*this.data[15]+this.data[0]*this.data[7]*this.data[14]+this.data[4]*this.data[2]*this.data[15]-this.data[4]*this.data[3]*this.data[14]-this.data[12]*this.data[2]*this.data[7]+this.data[12]*this.data[3]*this.data[6],e.data[10]=this.data[0]*this.data[5]*this.data[15]-this.data[0]*this.data[7]*this.data[13]-this.data[4]*this.data[1]*this.data[15]+this.data[4]*this.data[3]*this.data[13]+this.data[12]*this.data[1]*this.data[7]-this.data[12]*this.data[3]*this.data[5],e.data[14]=-this.data[0]*this.data[5]*this.data[14]+this.data[0]*this.data[6]*this.data[13]+this.data[4]*this.data[1]*this.data[14]-this.data[4]*this.data[2]*this.data[13]-this.data[12]*this.data[1]*this.data[6]+this.data[12]*this.data[2]*this.data[5],e.data[3]=-this.data[1]*this.data[6]*this.data[11]+this.data[1]*this.data[7]*this.data[10]+this.data[5]*this.data[2]*this.data[11]-this.data[5]*this.data[3]*this.data[10]-this.data[9]*this.data[2]*this.data[7]+this.data[9]*this.data[3]*this.data[6],e.data[7]=this.data[0]*this.data[6]*this.data[11]-this.data[0]*this.data[7]*this.data[10]-this.data[4]*this.data[2]*this.data[11]+this.data[4]*this.data[3]*this.data[10]+this.data[8]*this.data[2]*this.data[7]-this.data[8]*this.data[3]*this.data[6],e.data[11]=-this.data[0]*this.data[5]*this.data[11]+this.data[0]*this.data[7]*this.data[9]+this.data[4]*this.data[1]*this.data[11]-this.data[4]*this.data[3]*this.data[9]-this.data[8]*this.data[1]*this.data[7]+this.data[8]*this.data[3]*this.data[5],e.data[15]=this.data[0]*this.data[5]*this.data[10]-this.data[0]*this.data[6]*this.data[9]-this.data[4]*this.data[1]*this.data[10]+this.data[4]*this.data[2]*this.data[9]+this.data[8]*this.data[1]*this.data[6]-this.data[8]*this.data[2]*this.data[5],t=this.data[0]*e.data[0]+this.data[1]*e.data[4]+this.data[2]*e.data[8]+this.data[3]*e.data[12],e.mult(1/t)},i.prototype.decompose=function(){var t=new r(this.col(0)),e=new r(this.col(1)),i=new r(this.col(2)),n=new r(this.col(3));return{left:t.normalize(),up:e.normalize(),forward:i.normalize(),origin:n,scale:new r(t.length(),e.length(),i.length())}},i.random=function(){var t=i.rotationRadians(360*Math.random(),r.random()),e=i.scale(10*Math.random()),n=i.translation(r.random());return n.mult(t.mult(e))},i.prototype.toString=function(){return this.data[0]+", "+this.data[4]+", "+this.data[8]+", "+this.data[12]+",\n"+this.data[1]+", "+this.data[5]+", "+this.data[9]+", "+this.data[13]+",\n"+this.data[2]+", "+this.data[6]+", "+this.data[10]+", "+this.data[14]+",\n"+this.data[3]+", "+this.data[7]+", "+this.data[11]+", "+this.data[15]},i.prototype.toArray=function(){return this.data.slice(0)},e.exports=i}()},{"./Mat33":2,"./Vec3":8,"./Vec4":9}],4:[function(t,e){!function(){"use strict";function i(){switch(arguments.length){case 1:var t=arguments[0];this.w=void 0!==t.w?t.w:void 0!==t[0]?t[0]:1,this.x=t.x||t[1]||0,this.y=t.y||t[2]||0,this.z=t.z||t[3]||0;break;case 4:this.w=arguments[0],this.x=arguments[1],this.y=arguments[2],this.z=arguments[3];break;default:this.w=1,this.x=0,this.y=0,this.z=0}return this}var r=t("./Vec3"),n=t("./Mat33");i.identity=function(){return new i(1,0,0,0)},i.prototype.negate=function(){return new i(-this.w,-this.x,-this.y,-this.z)},i.prototype.mult=function(t){t=t instanceof Array?new i(t):t;var e=t.w*this.w-t.x*this.x-t.y*this.y-t.z*this.z,r=this.y*t.z-this.z*t.y+this.w*t.x+this.x*t.w,n=this.z*t.x-this.x*t.z+this.w*t.y+this.y*t.w,a=this.x*t.y-this.y*t.x+this.w*t.z+this.z*t.w;return new i(e,r,n,a)},i.prototype.rotate=function(t){t=t instanceof Array?new r(t):t;var e=new i(0,t.x,t.y,t.z),n=this.mult(e).mult(this.inverse());return new r(n.x,n.y,n.z)},i.prototype.matrix=function(){var t=this.x*this.x,e=this.y*this.y,i=this.z*this.z,r=this.x*this.y,a=this.x*this.z,s=this.x*this.w,o=this.y*this.z,h=this.y*this.w,u=this.z*this.w;return new n([1-2*e-2*i,2*r+2*u,2*a-2*h,2*r-2*u,1-2*t-2*i,2*o+2*s,2*a+2*h,2*o-2*s,1-2*t-2*e])},i.rotationDegrees=function(t,e){return i.rotationRadians(t*(Math.PI/180),e)},i.rotationRadians=function(t,e){e instanceof Array&&(e=new r(e)),e=e.normalize();var n=t>0?t%(2*Math.PI):t%(-2*Math.PI),a=Math.sin(n/2),s=Math.cos(n/2);return new i(s,e.x*a,e.y*a,e.z*a).normalize()},i.slerp=function(t,e,r){t instanceof Array&&(t=new i(t)),e instanceof Array&&(e=new i(e));var n=t.w*e.w+t.x*e.x+t.y*e.y+t.z*e.z;if(Math.abs(n)>=1)return new i(t.w,t.x,t.y,t.z);0>n&&(t=t.negate(),n=-n);var a=Math.acos(n),s=Math.sqrt(1-n*n),o=Math.sin((1-r)*a)/s,h=Math.sin(r*a)/s;return new i(t.w*o+e.w*h,t.x*o+e.x*h,t.y*o+e.y*h,t.z*o+e.z*h)},i.prototype.equals=function(t,e){var i=void 0!==t.w?t.w:t[0],r=void 0!==t.x?t.x:t[1],n=void 0!==t.y?t.y:t[2],a=void 0!==t.z?t.z:t[3];return e=void 0===e?0:e,(this.w===i||Math.abs(this.w-i)<=e)&&(this.x===r||Math.abs(this.x-r)<=e)&&(this.y===n||Math.abs(this.y-n)<=e)&&(this.z===a||Math.abs(this.z-a)<=e)},i.prototype.normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0!==t?new i(this.w/t,this.x/t,this.y/t,this.z/t):new i},i.prototype.conjugate=function(){return new i(this.w,-this.x,-this.y,-this.z)},i.prototype.inverse=function(){return this.conjugate()},i.random=function(){var t=r.random().normalize(),e=Math.random();return i.rotationRadians(e,t)},i.prototype.toString=function(){return this.x+", "+this.y+", "+this.z+", "+this.w},i.prototype.toArray=function(){return[this.w,this.x,this.y,this.z]},e.exports=i}()},{"./Mat33":2,"./Vec3":8}],5:[function(t,e){!function(){"use strict";function i(t){return t=t||{},t._up&&t._forward&&t._left&&t._origin&&t._scale?(this._up=t.up(),this._forward=t.forward(),this._left=t.left(),this._origin=t.origin(),this._scale=t.scale()):t.data&&t.data instanceof Array?(t=t.decompose(),this._up=t.up,this._forward=t.forward,this._left=t.left,this._scale=t.scale,this._origin=t.origin||new r(0,0,0)):(this._up=t.up?new r(t.up).normalize():new r(0,1,0),this._forward=t.forward?new r(t.forward).normalize():new r(0,0,1),this._left=t.left?new r(t.left).normalize():this._up.cross(this._forward).normalize(),this.origin(t.origin||new r(0,0,0)),this.scale(t.scale||new r(1,1,1))),this}var r=t("./Vec3"),n=t("./Mat33"),a=t("./Mat44");i.identity=function(){return new i({up:new r(0,1,0),forward:new r(0,0,1),left:new r(1,0,0),origin:new r(0,0,0),scale:new r(1,1,1)})},i.prototype.origin=function(t){return t?(this._origin=new r(t),this):new r(this._origin)},i.prototype.forward=function(t){if(t){t=t instanceof Array?new r(t).normalize():t.normalize();var e=n.rotationFromTo(this._forward,t);return this._forward=t,this._up=e.mult(this._up).normalize(),this._left=e.mult(this._left).normalize(),this}return new r(this._forward)},i.prototype.up=function(t){if(t){t=t instanceof Array?new r(t).normalize():t.normalize();var e=n.rotationFromTo(this._up,t);return this._forward=e.mult(this._forward).normalize(),this._up=t,this._left=e.mult(this._left).normalize(),this}return new r(this._up)},i.prototype.left=function(t){if(t){t=t instanceof Array?new r(t).normalize():t.normalize();var e=n.rotationFromTo(this._left,t);return this._forward=e.mult(this._forward).normalize(),this._up=e.mult(this._up).normalize(),this._left=t,this}return new r(this._left)},i.prototype.scale=function(t){return t?(this._scale="number"==typeof t?new r(t,t,t):new r(t),this):this._scale},i.prototype.mult=function(t){return new i(t instanceof Array||t.data instanceof Array?this.matrix().mult(t):this.matrix().mult(t.matrix()))},i.prototype.scaleMatrix=function(){return a.scale(this._scale)},i.prototype.rotationMatrix=function(){return new a([this._left.x,this._left.y,this._left.z,0,this._up.x,this._up.y,this._up.z,0,this._forward.x,this._forward.y,this._forward.z,0,0,0,0,1])},i.prototype.translationMatrix=function(){return a.translation(this._origin)},i.prototype.matrix=function(){return this.translationMatrix().mult(this.rotationMatrix()).mult(this.scaleMatrix())},i.prototype.inverseScaleMatrix=function(){return a.scale(new r(1/this._scale.x,1/this._scale.y,1/this._scale.z))},i.prototype.inverseRotationMatrix=function(){return new a([this._left.x,this._up.x,this._forward.x,0,this._left.y,this._up.y,this._forward.y,0,this._left.z,this._up.z,this._forward.z,0,0,0,0,1])},i.prototype.inverseTranslationMatrix=function(){return a.translation(this._origin.negate())},i.prototype.inverseMatrix=function(){return this.inverseScaleMatrix().mult(this.inverseRotationMatrix()).mult(this.inverseTranslationMatrix())},i.prototype.viewMatrix=function(){var t=this._origin.negate(),e=this._left.negate(),i=this._forward.negate();return new a([e.x,this._up.x,i.x,0,e.y,this._up.y,i.y,0,e.z,this._up.z,i.z,0,t.dot(e),t.dot(this._up),t.dot(i),1])},i.prototype.translateWorld=function(t){return this._origin=this._origin.add(t),this},i.prototype.translateLocal=function(t){return t instanceof Array&&(t=new r(t)),this._origin=this._origin.add(this._left.mult(t.x)).add(this._up.mult(t.y)).add(this._forward.mult(t.z)),this},i.prototype.rotateWorldDegrees=function(t,e){return this.rotateWorldRadians(t*Math.PI/180,e)},i.prototype.rotateWorldRadians=function(t,e){var i=n.rotationRadians(t,e);return this._up=i.mult(this._up),this._forward=i.mult(this._forward),this._left=i.mult(this._left),this},i.prototype.rotateLocalDegrees=function(t,e){return this.rotateWorldDegrees(t,this.rotationMatrix().mult(e))},i.prototype.rotateLocalRadians=function(t,e){return this.rotateWorldRadians(t,this.rotationMatrix().mult(e))},i.prototype.localToWorld=function(t,e,i,r){var n=new a;return e||(n=this.scaleMatrix().mult(n)),i||(n=this.rotationMatrix().mult(n)),r||(n=this.translationMatrix().mult(n)),n.mult(t)},i.prototype.worldToLocal=function(t,e,i,r){var n=new a;return r||(n=this.inverseTranslationMatrix().mult(n)),i||(n=this.inverseRotationMatrix().mult(n)),e||(n=this.inverseScaleMatrix().mult(n)),n.mult(t)},i.prototype.equals=function(t,e){return this._origin.equals(t.origin(),e)&&this._forward.equals(t.forward(),e)&&this._up.equals(t.up(),e)&&this._left.equals(t.left(),e)&&this._scale.equals(t.scale(),e)},i.random=function(){return(new i).origin(r.random()).forward(r.random()).scale(r.random())},i.prototype.toString=function(){return this.matrix().toString()},e.exports=i}()},{"./Mat33":2,"./Mat44":3,"./Vec3":8}],6:[function(t,e){!function(){"use strict";function i(){switch(arguments.length){case 1:var t=arguments[0];this.a=new r(t[0]||t.a),this.b=new r(t[1]||t.b),this.c=new r(t[2]||t.c);break;case 3:this.a=new r(arguments[0]),this.b=new r(arguments[1]),this.c=new r(arguments[2]);break;default:this.a=new r(0,0,0),this.b=new r(1,0,0),this.c=new r(1,1,0)}}var r=t("./Vec3");i.prototype.radius=function(){var t=this.centroid(),e=this.a.sub(t).length(),i=this.b.sub(t).length(),r=this.c.sub(t).length();return Math.max(e,Math.max(i,r))},i.prototype.centroid=function(){return this.a.add(this.b).add(this.c).div(3)},i.prototype.normal=function(){var t=this.b.sub(this.a),e=this.c.sub(this.a);return t.cross(e).normalize()},i.random=function(){var t=r.random(),e=r.random(),n=r.random(),a=t.add(e).add(n).div(3),s=t.sub(a),o=e.sub(a),h=n.sub(a),u=s.length(),d=o.length(),f=h.length(),c=Math.max(Math.max(u,d),f),l=1/c;return new i(s.mult(l),o.mult(l),h.mult(l))},i.prototype.equals=function(t,e){return e=void 0===e?0:e,this.a.equals(t.a,e)&&this.b.equals(t.b,e)&&this.c.equals(t.c,e)},i.prototype.toString=function(){return this.a.toString()+", "+this.b.toString()+", "+this.c.toString()},e.exports=i}()},{"./Vec3":8}],7:[function(t,e){!function(){"use strict";function t(){switch(arguments.length){case 1:var t=arguments[0];this.x=t.x||t[0]||0,this.y=t.y||t[1]||0;break;case 2:this.x=arguments[0],this.y=arguments[1];break;default:this.x=0,this.y=0}return this}t.prototype.negate=function(){return new t(-this.x,-this.y)},t.prototype.add=function(e){return e instanceof Array?new t(this.x+e[0],this.y+e[1]):new t(this.x+e.x,this.y+e.y)},t.prototype.sub=function(e){return e instanceof Array?new t(this.x-e[0],this.y-e[1]):new t(this.x-e.x,this.y-e.y)},t.prototype.mult=function(e){return new t(this.x*e,this.y*e)},t.prototype.div=function(e){return new t(this.x/e,this.y/e)},t.prototype.dot=function(t){return t instanceof Array?this.x*t[0]+this.y*t[1]:this.x*t.x+this.y*t.y},t.prototype.cross=function(t){return t instanceof Array?this.x*t[1]-this.y*t[0]:this.x*t.y-this.y*t.x},t.prototype.length=function(t){return void 0===t?Math.sqrt(this.dot(this)):this.normalize().mult(t)},t.prototype.lengthSquared=function(){return this.dot(this)},t.prototype.equals=function(t,e){var i=void 0!==t.x?t.x:t[0],r=void 0!==t.y?t.y:t[1];return e=void 0===e?0:e,(this.x===i||Math.abs(this.x-i)<=e)&&(this.y===r||Math.abs(this.y-r)<=e)},t.prototype.normalize=function(){var e=this.length();return 0!==e?new t(this.x/e,this.y/e):new t},t.random=function(){return new t(Math.random(),Math.random()).normalize()},t.prototype.toString=function(){return this.x+", "+this.y},t.prototype.toArray=function(){return[this.x,this.y]},e.exports=t}()},{}],8:[function(t,e){!function(){"use strict";function t(){switch(arguments.length){case 1:var t=arguments[0];this.x=t.x||t[0]||0,this.y=t.y||t[1]||0,this.z=t.z||t[2]||0;break;case 3:this.x=arguments[0],this.y=arguments[1],this.z=arguments[2];break;default:this.x=0,this.y=0,this.z=0}return this}t.prototype.negate=function(){return new t(-this.x,-this.y,-this.z)},t.prototype.add=function(e){return e instanceof Array?new t(this.x+e[0],this.y+e[1],this.z+e[2]):new t(this.x+e.x,this.y+e.y,this.z+e.z)},t.prototype.sub=function(e){return e instanceof Array?new t(this.x-e[0],this.y-e[1],this.z-e[2]):new t(this.x-e.x,this.y-e.y,this.z-e.z)},t.prototype.mult=function(e){return new t(this.x*e,this.y*e,this.z*e)},t.prototype.div=function(e){return new t(this.x/e,this.y/e,this.z/e)},t.prototype.dot=function(t){return t instanceof Array?this.x*t[0]+this.y*t[1]+this.z*t[2]:this.x*t.x+this.y*t.y+this.z*t.z},t.prototype.cross=function(e){return e instanceof Array?new t(this.y*e[2]-e[1]*this.z,-this.x*e[2]+e[0]*this.z,this.x*e[1]-e[0]*this.y):new t(this.y*e.z-e.y*this.z,-this.x*e.z+e.x*this.z,this.x*e.y-e.x*this.y)},t.prototype.length=function(t){return void 0===t?Math.sqrt(this.dot(this)):this.normalize().mult(t)},t.prototype.lengthSquared=function(){return this.dot(this)},t.prototype.equals=function(t,e){var i=void 0!==t.x?t.x:t[0],r=void 0!==t.y?t.y:t[1],n=void 0!==t.z?t.z:t[2];return e=void 0===e?0:e,(this.x===i||Math.abs(this.x-i)<=e)&&(this.y===r||Math.abs(this.y-r)<=e)&&(this.z===n||Math.abs(this.z-n)<=e)},t.prototype.normalize=function(){var e=this.length();return 0!==e?new t(this.x/e,this.y/e,this.z/e):new t},t.random=function(){return new t(Math.random(),Math.random(),Math.random()).normalize()},t.prototype.toString=function(){return this.x+", "+this.y+", "+this.z},t.prototype.toArray=function(){return[this.x,this.y,this.z]},e.exports=t}()},{}],9:[function(t,e){!function(){"use strict";function t(){switch(arguments.length){case 1:var t=arguments[0];this.x=t.x||t[0]||0,this.y=t.y||t[1]||0,this.z=t.z||t[2]||0,this.w=t.w||t[3]||0;break;case 4:this.x=arguments[0],this.y=arguments[1],this.z=arguments[2],this.w=arguments[3];break;default:this.x=0,this.y=0,this.z=0,this.w=0}return this}t.prototype.negate=function(){return new t(-this.x,-this.y,-this.z,-this.w)},t.prototype.add=function(e){return e instanceof Array?new t(this.x+e[0],this.y+e[1],this.z+e[2],this.w+e[3]):new t(this.x+e.x,this.y+e.y,this.z+e.z,this.w+e.w)},t.prototype.sub=function(e){return e instanceof Array?new t(this.x-e[0],this.y-e[1],this.z-e[2],this.w-e[3]):new t(this.x-e.x,this.y-e.y,this.z-e.z,this.w-e.w)},t.prototype.mult=function(e){return new t(this.x*e,this.y*e,this.z*e,this.w*e)},t.prototype.div=function(e){return new t(this.x/e,this.y/e,this.z/e,this.w/e)},t.prototype.dot=function(t){return t instanceof Array?this.x*t[0]+this.y*t[1]+this.z*t[2]+this.w*t[3]:this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},t.prototype.length=function(t){return void 0===t?Math.sqrt(this.dot(this)):this.normalize().mult(t)},t.prototype.lengthSquared=function(){return this.dot(this)},t.prototype.equals=function(t,e){var i=void 0!==t.x?t.x:t[0],r=void 0!==t.y?t.y:t[1],n=void 0!==t.z?t.z:t[2],a=void 0!==t.w?t.w:t[3];return e=void 0===e?0:e,(this.x===i||Math.abs(this.x-i)<=e)&&(this.y===r||Math.abs(this.y-r)<=e)&&(this.z===n||Math.abs(this.z-n)<=e)&&(this.w===a||Math.abs(this.w-a)<=e)},t.prototype.normalize=function(){var e=this.length();return 0!==e?new t(this.x/e,this.y/e,this.z/e,this.w/e):new t},t.random=function(){return new t(Math.random(),Math.random(),Math.random(),Math.random()).normalize()},t.prototype.toString=function(){return this.x+", "+this.y+", "+this.z+", "+this.w},t.prototype.toArray=function(){return[this.x,this.y,this.z,this.w]},e.exports=t}()},{}],10:[function(t,e){!function(){"use strict";e.exports={Mat33:t("./Mat33"),Mat44:t("./Mat44"),Vec2:t("./Vec2"),Vec3:t("./Vec3"),Vec4:t("./Vec3"),Quaternion:t("./Quaternion"),Transform:t("./Transform"),Triangle:t("./Triangle")}}()},{"./Mat33":2,"./Mat44":3,"./Quaternion":4,"./Transform":5,"./Triangle":6,"./Vec2":7,"./Vec3":8}],11:[function(t,e,i){(function(t){function e(t,e){for(var i=0,r=t.length-1;r>=0;r--){var n=t[r];"."===n?t.splice(r,1):".."===n?(t.splice(r,1),i++):i&&(t.splice(r,1),i--)}if(e)for(;i--;i)t.unshift("..");return t}function r(t,e){if(t.filter)return t.filter(e);for(var i=[],r=0;r<t.length;r++)e(t[r],r,t)&&i.push(t[r]);return i}var n=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,a=function(t){return n.exec(t).slice(1)};i.resolve=function(){for(var i="",n=!1,a=arguments.length-1;a>=-1&&!n;a--){var s=a>=0?arguments[a]:t.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(i=s+"/"+i,n="/"===s.charAt(0))}return i=e(r(i.split("/"),function(t){return!!t}),!n).join("/"),(n?"/":"")+i||"."},i.normalize=function(t){var n=i.isAbsolute(t),a="/"===s(t,-1);return t=e(r(t.split("/"),function(t){return!!t
}),!n).join("/"),t||n||(t="."),t&&a&&(t+="/"),(n?"/":"")+t},i.isAbsolute=function(t){return"/"===t.charAt(0)},i.join=function(){var t=Array.prototype.slice.call(arguments,0);return i.normalize(r(t,function(t){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},i.relative=function(t,e){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var i=t.length-1;i>=0&&""===t[i];i--);return e>i?[]:t.slice(e,i-e+1)}t=i.resolve(t).substr(1),e=i.resolve(e).substr(1);for(var n=r(t.split("/")),a=r(e.split("/")),s=Math.min(n.length,a.length),o=s,h=0;s>h;h++)if(n[h]!==a[h]){o=h;break}for(var u=[],h=o;h<n.length;h++)u.push("..");return u=u.concat(a.slice(o)),u.join("/")},i.sep="/",i.delimiter=":",i.dirname=function(t){var e=a(t),i=e[0],r=e[1];return i||r?(r&&(r=r.substr(0,r.length-1)),i+r):"."},i.basename=function(t,e){var i=a(t)[2];return e&&i.substr(-1*e.length)===e&&(i=i.substr(0,i.length-e.length)),i},i.extname=function(t){return a(t)[3]};var s="b"==="ab".substr(-1)?function(t,e,i){return t.substr(e,i)}:function(t,e,i){return 0>e&&(e=t.length+e),t.substr(e,i)}}).call(this,t("_process"))},{_process:12}],12:[function(t,e){function i(){if(!s){s=!0;for(var t,e=a.length;e;){t=a,a=[];for(var i=-1;++i<e;)t[i]();e=a.length}s=!1}}function r(){}var n=e.exports={},a=[],s=!1;n.nextTick=function(t){a.push(t),s||setTimeout(i,0)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=r,n.addListener=r,n.once=r,n.off=r,n.removeListener=r,n.removeAllListeners=r,n.emit=r,n.binding=function(){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],13:[function(e,i,r){(function(){var e,i,n,a,s,o,h,u,d,f,c,l,p,y,m=[].slice;s="3.0.0",i="pending",a="resolved",n="rejected",d=function(t,e){return null!=t?t.hasOwnProperty(e):void 0},c=function(t){return d(t,"length")&&d(t,"callee")},l=function(t){return d(t,"promise")&&"function"==typeof(null!=t?t.promise:void 0)},u=function(t){return c(t)?u(Array.prototype.slice.call(t)):Array.isArray(t)?t.reduce(function(t,e){return Array.isArray(e)?t.concat(u(e)):(t.push(e),t)},[]):[t]},o=function(t,e){return 0>=t?e():function(){return--t<1?e.apply(this,arguments):void 0}},p=function(t,e){return function(){var i;return i=[t].concat(Array.prototype.slice.call(arguments,0)),e.apply(this,i)}},h=function(t,e,i){var r,n,a,s,o;for(s=u(t),o=[],n=0,a=s.length;a>n;n++)r=s[n],o.push(r.call.apply(r,[i].concat(m.call(e))));return o},e=function(){var t,r,s,o,d,f,c;return c=i,o=[],d=[],f=[],s={resolved:{},rejected:{},pending:{}},this.promise=function(t){var r,p;return t=t||{},t.state=function(){return c},p=function(e,r,n){return function(){return c===i&&r.push.apply(r,u(arguments)),e()&&h(arguments,s[n]),t}},t.done=p(function(){return c===a},o,a),t.fail=p(function(){return c===n},d,n),t.progress=p(function(){return c!==i},f,i),t.always=function(){var e;return(e=t.done.apply(t,arguments)).fail.apply(e,arguments)},r=function(i,r,n){var a,s;return s=new e,a=function(e,i,r){return t[e](r?function(){var t,e;return t=1<=arguments.length?m.call(arguments,0):[],e=r.apply(null,t),l(e)?e.done(s.resolve).fail(s.reject).progress(s.notify):s[i](e)}:s[i])},a("done","resolve",i),a("fail","reject",r),a("progress","notify",n),s},t.pipe=r,t.then=r,null==t.promise&&(t.promise=function(){return t}),t},this.promise(this),t=this,r=function(e,r,n){return function(){return c===i?(c=e,s[e]=arguments,h(r,s[e],n),t):this}},this.resolve=r(a,o),this.reject=r(n,d),this.notify=r(i,f),this.resolveWith=function(t,e){return r(a,o,t).apply(null,e)},this.rejectWith=function(t,e){return r(n,d,t).apply(null,e)},this.notifyWith=function(t,e){return r(i,f,t).apply(null,e)},this},y=function(){var t,i,r,n,a,s,h;if(i=u(arguments),1===i.length)return l(i[0])?i[0]:(new e).resolve(i[0]).promise();if(a=new e,!i.length)return a.resolve().promise();for(n=[],r=o(i.length,function(){return a.resolve.apply(a,n)}),i.forEach(function(t,e){return l(t)?t.done(function(){var t;return t=1<=arguments.length?m.call(arguments,0):[],n[e]=t.length>1?t:t[0],r()}):(n[e]=t,r())}),s=0,h=i.length;h>s;s++)t=i[s],l(t)&&t.fail(a.reject);return a.promise()},f=function(t){return t.Deferred=function(){return new e},t.ajax=p(t.ajax,function(t,i){var r,n,a,s;return null==i&&(i={}),n=new e,r=function(t,e){return p(t,function(){var t,i;return i=arguments[0],t=2<=arguments.length?m.call(arguments,1):[],i&&i.apply(null,t),e.apply(null,t)})},i.success=r(i.success,n.resolve),i.error=r(i.error,n.reject),s=t(i),a=n.promise(),a.abort=function(){return s.abort()},a}),t.when=y},"undefined"!=typeof r?(r.Deferred=function(){return new e},r.when=y,r.installInto=f):"function"==typeof t&&t.amd?t(function(){return"undefined"!=typeof Zepto?f(Zepto):(e.when=y,e.installInto=f,e)}):"undefined"!=typeof Zepto?f(Zepto):(this.Deferred=function(){return new e},this.Deferred.when=y,this.Deferred.installInto=f)}).call(this)},{}],14:[function(t,e){!function(){"use strict";function i(t,e){t.renderTarget.setColorTarget(t.cubeMap,c[e]),t.renderTarget.clear()}function r(t,e){var i,r;switch(t){case"+x":i=[1,0,0],r=[0,-1,0];break;case"-x":i=[-1,0,0],r=[0,-1,0];break;case"+y":i=[0,1,0],r=[0,0,1];break;case"-y":i=[0,-1,0],r=[0,0,-1];break;case"+z":i=[0,0,1],r=[0,-1,0];break;case"-z":i=[0,0,-1],r=[0,-1,0]}return new d({origin:e,forward:i,up:r,projection:{fov:90,aspect:1,zMin:1,zMax:1e3}})}function n(t){var e=this.gl=a.get();t=t||{},this.id=e.createFramebuffer(),this.resolution=t.resolution||l,this.depthTexture=new o({format:"DEPTH_COMPONENT",type:"UNSIGNED_SHORT",width:this.resolution,height:this.resolution}),this.cubeMap=new h({data:null,width:this.resolution,height:this.resolution}),this.renderTarget=new s,this.renderTarget.setDepthTarget(this.depthTexture),this.viewport=new u}var a=t("./WebGLContext"),s=t("./RenderTarget"),o=t("./Texture2D"),h=t("./TextureCubeMap"),u=t("./Viewport"),d=t("../render/Camera"),f=["-x","+x","-y","+y","-z","+z"],c={"+z":"TEXTURE_CUBE_MAP_POSITIVE_Z","-z":"TEXTURE_CUBE_MAP_NEGATIVE_Z","+x":"TEXTURE_CUBE_MAP_POSITIVE_X","-x":"TEXTURE_CUBE_MAP_NEGATIVE_X","+y":"TEXTURE_CUBE_MAP_POSITIVE_Y","-y":"TEXTURE_CUBE_MAP_NEGATIVE_Y"},l=2048;n.prototype.push=function(t){return this.cubeMap.push(t),this},n.prototype.pop=function(t){return this.cubeMap.pop(t),this},n.prototype.render=function(t,e,n){var a=this;return this.renderTarget.push(),this.viewport.push(this.resolution,this.resolution),f.forEach(function(s){i(a,s),e.render(r(s,t),n)}),this.renderTarget.pop(),this.viewport.pop(),this},e.exports=n}()},{"../render/Camera":26,"./RenderTarget":16,"./Texture2D":19,"./TextureCubeMap":20,"./Viewport":23,"./WebGLContext":24}],15:[function(t,e){!function(){"use strict";function i(t,e){e=e||{},this.gl=r.get(),this.id=0,this.count=0,this.offset=void 0!==e.offset?e.offset:0,this.mode=e.mode||"TRIANGLES",t instanceof WebGLBuffer?(this.id=t,this.type=e.type||"UNSIGNED_SHORT",this.count=void 0!==e.count?e.count:0):this.bufferData(t)}var r=t("./WebGLContext"),n=null;i.prototype.bufferData=function(t){var e=this.gl,i=r.checkExtension("OES_element_index_uint");if(i?t instanceof Array&&(t=new Uint32Array(t)):t instanceof Array?t=new Uint16Array(t):t instanceof Uint32Array&&(console.warn("Cannot create IndexBuffer of format gl.UNSIGNED_INT as OES_element_index_uint is not supported, defaulting to gl.UNSIGNED_SHORT"),t=new Uint16Array(t)),t instanceof Uint16Array)this.type="UNSIGNED_SHORT";else{if(!(t instanceof Uint32Array))return void console.error("IndexBuffer requires an Array or ArrayBuffer argument, command ignored");this.type="UNSIGNED_INT"}return this.id=e.createBuffer(),this.count=t.length,e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.id),e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW),this},i.prototype.bind=function(){if(n!==this){var t=this.gl;return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.id),n=this,this}},i.prototype.unbind=function(){if(null!==n){var t=this.gl;return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),n=null,this}},i.prototype.draw=function(){if(null===n)return void console.warn("No IndexBuffer is bound, command ignored.");var t=this.gl;return t.drawElements(t[this.mode],this.count,t[this.type],this.offset),this},e.exports=i}()},{"./WebGLContext":24}],16:[function(t,e){!function(){"use strict";function i(t){if(h!==t){var e=t.gl;e.bindFramebuffer(e.FRAMEBUFFER,t.id),h=t}}function r(t){if(null!==h){var e=t.gl;e.bindFramebuffer(e.FRAMEBUFFER,null),h=null}}function n(){var t=this.gl=a.get();return this.id=t.createFramebuffer(),this.textures={},this}var a=t("./WebGLContext"),s=t("../util/Stack"),o=new s,h=null;n.prototype.push=function(){return o.push(this),i(this),this},n.prototype.pop=function(){var t;return o.pop(),t=o.top(),t?i(t):r(this),this},n.prototype.setColorTarget=function(t,e,i){var r=this.gl;return"string"==typeof e&&(i=e,e=void 0),e=void 0!==e?e:0,this.textures["color"+e]=t,this.push(),r.framebufferTexture2D(r.FRAMEBUFFER,r["COLOR_ATTACHMENT"+e],r[i||"TEXTURE_2D"],t.id,0),this.pop(),this},n.prototype.setDepthTarget=function(t){var e=this.gl;return this.textures.depth=t,this.push(),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,t.id,0),this.pop(),this},n.prototype.clearColor=function(t,e,i,r){var n=this.gl;return t=void 0!==t?t:0,e=void 0!==e?e:0,i=void 0!==i?i:0,r=void 0!==r?r:0,this.push(),n.clearColor(t,e,i,r),n.clear(n.COLOR_BUFFER_BIT),this.pop(),this},n.prototype.clearDepth=function(t,e,i,r){var n=this.gl;return t=void 0!==t?t:0,e=void 0!==e?e:0,i=void 0!==i?i:0,r=void 0!==r?r:0,this.push(),n.clearColor(t,e,i,r),n.clear(n.DEPTH_BUFFER_BIT),this.pop(),this},n.prototype.clearStencil=function(t,e,i,r){var n=this.gl;return t=void 0!==t?t:0,e=void 0!==e?e:0,i=void 0!==i?i:0,r=void 0!==r?r:0,this.push(),n.clearColor(t,e,i,r),n.clear(n.STENCIL_BUFFER_BIT),this.pop(),this},n.prototype.clear=function(t,e,i,r){var n=this.gl;return t=void 0!==t?t:0,e=void 0!==e?e:0,i=void 0!==i?i:0,r=void 0!==r?r:0,this.push(),n.clearColor(t,e,i,r),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT|n.STENCIL_BUFFER_BIT),this.pop(),this},n.prototype.resize=function(t,e){var i;if(!t||!e)return console.warn("Width or height arguments missing, command ignored."),this;for(i in this.textures)this.textures.hasOwnProperty(i)&&this.textures[i].resize(t,e);return this},e.exports=n}()},{"../util/Stack":38,"./WebGLContext":24}],17:[function(t,e){!function(){"use strict";function i(t,e){var i,r,n=p.parseDeclarations([t,e],["uniform","attribute"]),a={},s={},o=0;for(r=0;r<n.length;r++)i=n[r],"attribute"===i.qualifier?a[i.name]={type:i.type,index:o++}:"uniform"===i.qualifier&&(s[i.name]={type:i.type,func:x[i.type]});return{attributes:a,uniforms:s}}function r(t,e,i){var r=t.createShader(t[i]);return t.shaderSource(r,e),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.error("An error occurred compiling the shaders: "+t.getShaderInfoLog(r)),null)}function n(t){var e,i=t.gl,r=t.attributes;for(e in r)r.hasOwnProperty(e)&&i.bindAttribLocation(t.id,r[e].index,e)}function a(t){var e,i,r=t.gl,n=t.uniforms;for(i in n)n.hasOwnProperty(i)&&(e=n[i],e.location=r.getUniformLocation(t.id,i))}function s(t){return function(e){m.load(t,{responseType:"text",success:e})}}function o(t){return function(e){e(t)}}function h(t){return function(e){var i=[];t=t||[],t=t instanceof Array?t:[t],t.forEach(function(t){i.push(p.isGLSL(t)?o(t):s(t))}),y.async(i,function(t){e(t)})}}function u(t){w!==t&&(t.gl.useProgram(t.id),w=t)}function d(t){null!==w&&(t.gl.useProgram(null),w=null)}function f(t){return t.id=null,t.attributes=null,t.uniforms=null,t}function c(t,e){var i=this;t=t||{},this.id=0,this.gl=l.get(),this.version=t.version||"1.00",t.vert||console.error("Vertex shader argument has not been provided, shader initialization aborted."),t.frag||console.error("Fragment shader argument has not been provided, shader initialization aborted."),y.async({common:h(t.common),vert:h(t.vert),frag:h(t.frag)},function(t){i.create(t),e&&e(i)})}var l=t("./WebGLContext"),p=t("./ShaderParser"),y=t("../util/Util"),m=t("../util/XHRLoader"),g=t("../util/Stack"),x={bool:"uniform1i","float":"uniform1f","int":"uniform1i",uint:"unfirom1i",vec2:"uniform2fv",ivec2:"uniform2iv",vec3:"uniform3fv",ivec3:"uniform3iv",vec4:"uniform4fv",ivec4:"uniform4iv",mat2:"uniformMatrix2fv",mat3:"uniformMatrix3fv",mat4:"uniformMatrix4fv",sampler2D:"uniform1i",samplerCube:"uniform1i"},v=new g,w=null;c.prototype.create=function(t){var e,s,o,h=this.gl,u=t.common.join(""),d=t.vert.join(""),c=t.frag.join("");return e=r(h,u+d,"VERTEX_SHADER"),s=r(h,u+c,"FRAGMENT_SHADER"),e&&s?(o=i(d,c),this.attributes=o.attributes,this.uniforms=o.uniforms,this.id=h.createProgram(),h.attachShader(this.id,e),h.attachShader(this.id,s),n(this),h.linkProgram(this.id),h.getProgramParameter(this.id,h.LINK_STATUS)?(a(this),this):(console.error("An error occured linking the shader: "+h.getProgramInfoLog(this.id)),console.error("Aborting instantiation of shader due to linking errors."),f(this))):(console.error("Aborting instantiation of shader due to compilation errors."),f(this))},c.prototype.push=function(){return v.push(this),u(this),this},c.prototype.pop=function(){var t;return v.pop(),t=v.top(),t?u(t):d(this),this},c.prototype.setUniform=function(t,e){if(!this.id)return void console.warn("Attempting to use an incomplete shader, ignoring command.");var i,r,n,a,s=this.uniforms[t];if(!s)return void console.warn('No uniform found under name"'+t+'", command ignored');if(void 0===e)return void console.warn('Argument passed for uniform "'+t+'" is undefined, command ignored');switch(i=s.func,r=s.type,n=s.location,a=e.toArray?e.toArray():e,a=a instanceof Array?new Float32Array(a):a,a="boolean"==typeof a?a?1:0:a,r){case"mat2":case"mat3":case"mat4":this.gl[i](n,!1,a);break;default:this.gl[i](n,a)}return this},e.exports=c}()},{"../util/Stack":38,"../util/Util":39,"../util/XHRLoader":40,"./ShaderParser":18,"./WebGLContext":24}],18:[function(t,e){!function(){"use strict";function t(t){return t.replace(/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,"")}function i(t){return t.replace(/(\r\n|\n|\r)/gm,"").replace(/\s{2,}/g," ")}function r(t){function e(t){var e=t.split(/[\[\]]/).map(function(t){return t.trim()});return{qualifier:n,precision:a,type:o,name:e[0],count:void 0===e[1]?1:parseInt(e[1],10)}}var i,r,n,a,o,h,u,d=[];for(i=t.split(",").map(function(t){return t.trim()}),r=i.shift().split(" "),n=r.shift(),a=r.shift(),s[a]?o=r.shift():(o=a,a=null),h=r.concat(i),u=0;u<h.length;u++)d.push(e(h[u]));return d}function n(e,n){var a,s,o=n instanceof Array?n.join("|"):n,h=new RegExp("^.*\\b("+o+")\\b.*","gm"),u=t(e),d=i(u),f=d.split(";"),c=[];for(s=0;s<f.length;s++)a=f[s].trim().match(h),a&&(c=c.concat(r(a[0])));return c}function a(t){var e={};return t.filter(function(t){return e[t.name]?!1:(e[t.name]=!0,!0)})}var s={highp:!0,mediump:!0,lowp:!0};e.exports={parseDeclarations:function(t,e){if(!e||0===e.length)return[];var i,r=t instanceof Array?t:[t],s=[];for(i=0;i<r.length;i++)s=s.concat(n(r[i],e));return a(s)},isGLSL:function(t){return/void\s+main\s*\(\s*\)\s*/.test(t)}}}()},{}],19:[function(t,e){!function(){"use strict";function i(t){if(!o.isPowerOfTwo(t.width)||!o.isPowerOfTwo(t.height)){var e=document.createElement("canvas");e.width=o.nextHighestPowerOfTwo(t.width),e.height=o.nextHighestPowerOfTwo(t.height);var i=e.getContext("2d");return i.drawImage(t,0,0,t.width,t.height,0,0,e.width,e.height),e}return t}function r(t,e){if(d!==t){var i=t.gl;e=i["TEXTURE"+e]||i.TEXTURE0,i.activeTexture(e),i.bindTexture(i.TEXTURE_2D,t.id),d=t}}function n(t){if(null!==d){var e=t.gl;e.bindTexture(e.TEXTURE_2D,null),d=null}}function a(t,e){var i=this;if(t=t||{},this.gl=s.get(),this.id=this.gl.createTexture(),this.wrap=t.wrap||"REPEAT",this.filter=t.filter||"LINEAR",t.image)this.bufferData(t.image),this.setParameters(this);else if(t.url){var r=new Image;r.onload=function(){i.bufferData(r),i.setParameters(this),e(i)},r.src=t.url}else{if("DEPTH_COMPONENT"===t.format){var n=s.checkExtension("WEBGL_depth_texture");if(!n)return void console.log("Cannot create Texture2D of format gl.DEPTH_COMPONENT as WEBGL_depth_texture is unsupported by this browser, command ignored");this.format=t.format,t.type&&"UNSIGNED_SHORT"!==t.type&&"UNSIGNED_INT"!==t.type?(console.log("Depth textures do not support type'"+t.type+"', defaulting to 'UNSIGNED_SHORT'."),this.type="UNSIGNED_SHORT"):this.type=t.type}else this.format=t.format||"RGBA",this.type=t.type||"UNSIGNED_BYTE";this.internalFormat=this.format,this.mipMap=t.mipMap||!1,this.bufferData(t.data||null,t.width,t.height),this.setParameters(this)}}var s=t("./WebGLContext"),o=t("../util/Util"),h=t("../util/Stack"),u={},d=null;a.prototype.push=function(t){return u[t]=u[t]||new h,u[t].push(this),r(this,t),this},a.prototype.pop=function(t){var e;return u[t]||console.warn("No texture was bound to texture unit '"+t+"'. Command ignored."),u[t].pop(),e=u[t].top(),e?r(e,t):n(this),this},a.prototype.bufferData=function(t,e,r){var n=this.gl;return this.push(),t instanceof HTMLImageElement?(t=i(t),this.image=t,this.width=t.width,this.height=t.height,this.mipMap=!0,n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)):(this.data=t,this.width=e||this.width,this.height=r||this.height,n.texImage2D(n.TEXTURE_2D,0,n[this.internalFormat],this.width,this.height,0,n[this.format],n[this.type],this.data)),this.mipMap&&n.generateMipmap(n.TEXTURE_2D),this.pop(),this},a.prototype.setParameters=function(t){var e=this.gl;if(this.push(),t.wrap&&(this.wrap=t.wrap,e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e[this.wrap.s||this.wrap]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e[this.wrap.t||this.wrap])),t.filter){this.filter=t.filter;var i=this.filter.min||this.filter;this.minMap&&(i+="_MIPMAP_LINEAR"),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e[this.filter.mag||this.filter]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e[i])}return this.pop(),this},a.prototype.resize=function(t,e){return this.image?void console.error("Cannot resize image based Texture2D"):t&&e?(this.bufferData(this.data,t,e),this):void console.warn("Width or height arguments missing, command ignored.")},e.exports=a}()},{"../util/Stack":38,"../util/Util":39,"./WebGLContext":24}],20:[function(t,e){!function(){"use strict";function i(t){if(!h.isPowerOfTwo(t.width)||!h.isPowerOfTwo(t.height)){var e=document.createElement("canvas");e.width=h.nextHighestPowerOfTwo(t.width),e.height=h.nextHighestPowerOfTwo(t.height);var i=e.getContext("2d");return i.drawImage(t,0,0,t.width,t.height,0,0,e.width,e.height),e}return t}function r(t,e){if(l!==t){var i=t.gl;e=i["TEXTURE"+e]||i.TEXTURE0,i.activeTexture(e),i.bindTexture(i.TEXTURE_CUBE_MAP,t.id),l=t}}function n(t){if(null!==l){var e=t.gl;e.bindTexture(e.TEXTURE_CUBE_MAP,null),l=null}}function a(t,e,i){return function(r){var n=new Image;n.onload=function(){t.bufferFaceData(i,n),r()},n.src=e}}function s(t,e){var i,r,n=this;if(this.gl=o.get(),this.id=this.gl.createTexture(),this.wrap=t.wrap||"CLAMP_TO_EDGE",this.filter=t.filter||"LINEAR",t.images){for(i in t.images)t.images.hasOwnProperty(i)&&this.bufferFaceData(i,t.images[i]);this.setParameters(this)}else if(t.urls){r={};for(i in t.urls)t.urls.hasOwnProperty(i)&&(r[i]=a(this,t.urls[i],i));h.async(r,function(){n.setParameters(n),e(n)})}else this.format=t.format||"RGBA",this.internalFormat=this.format,this.type=t.type||"UNSIGNED_BYTE",this.mipMap=t.mipMap||!1,d.forEach(function(e){var i=(t.data?t.data[e]:t.data)||null;n.bufferFaceData(e,i,t.width,t.height)}),this.setParameters(this)}var o=t("./WebGLContext"),h=t("../util/Util"),u=t("../util/Stack"),d=["-x","+x","-y","+y","-z","+z"],f={"+z":"TEXTURE_CUBE_MAP_POSITIVE_Z","-z":"TEXTURE_CUBE_MAP_NEGATIVE_Z","+x":"TEXTURE_CUBE_MAP_POSITIVE_X","-x":"TEXTURE_CUBE_MAP_NEGATIVE_X","+y":"TEXTURE_CUBE_MAP_POSITIVE_Y","-y":"TEXTURE_CUBE_MAP_NEGATIVE_Y"},c={},l=null;s.prototype.push=function(t){return c[t]=c[t]||new u,c[t].push(this),r(this,t),this},s.prototype.pop=function(t){var e;return c[t]||console.log("No texture was bound to texture unit '"+t+"'. Command ignored."),c[t].pop(),e=c[t].top(),e?r(e,t):n(this),this},s.prototype.bufferFaceData=function(t,e,r,n){var a=this.gl,s=a[f[t]];return s||console.log("Invalid face enumeration '"+t+"' provided, ignoring command."),this.push(),e instanceof HTMLImageElement?(this.images=this.images||{},this.images[t]=i(e),this.filter="LINEAR",this.mipMap=!0,a.texImage2D(s,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.images[t])):(this.data=this.data||{},this.data[t]=e,this.width=r||this.width,this.height=n||this.height,a.texImage2D(s,0,a[this.internalFormat],this.width,this.height,0,a[this.format],a[this.type],e)),this.bufferedFaces=this.bufferedFaces||{},this.bufferedFaces[t]=!0,this.mipMap&&this.bufferedFaces["-x"]&&this.bufferedFaces["+x"]&&this.bufferedFaces["-y"]&&this.bufferedFaces["+y"]&&this.bufferedFaces["-z"]&&this.bufferedFaces["+z"]&&a.generateMipmap(a.TEXTURE_CUBE_MAP),this.pop(),this},s.prototype.setParameters=function(t){var e=this.gl;if(this.push(),t.wrap&&(this.wrap=t.wrap,e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_S,e[this.wrap.s||this.wrap]),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_T,e[this.wrap.t||this.wrap])),t.filter){this.filter=t.filter;var i=this.filter.min||this.filter;this.minMap&&(i+="_MIPMAP_LINEAR"),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e[this.filter.mag||this.filter]),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e[i])}return this.pop(),this},e.exports=s}()},{"../util/Stack":38,"../util/Util":39,"./WebGLContext":24}],21:[function(t,e){!function(){"use strict";function i(t,e){return e?void(t.pointers=e):void console.error("VertexBuffer requires attribute pointers to be specified, command ignored")}function r(t,e){this.id=0,this.pointers={},this.gl=n.get(),t&&(t instanceof a?(this.bufferData(t.buffer()),i(this,t.attributePointers())):t instanceof WebGLBuffer?(this.id=t,i(this,e)):(this.bufferData(t),i(this,e)))}var n=t("./WebGLContext"),a=t("./VertexPackage"),s=t("../util/Util"),o=null,h=null;r.prototype.bufferData=function(t){var e=this.gl;if(t instanceof Array)t=new Float32Array(t);else if(!s.isTypedArray(t)&&"number"!=typeof t)return void console.error("VertexBuffer requires an Array or ArrayBuffer, or a size argument, command ignored");this.id||(this.id=e.createBuffer()),e.bindBuffer(e.ARRAY_BUFFER,this.id),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)},r.prototype.bufferSubData=function(t,e){var i=this.gl;if(!this.id)return void console.error("VertexBuffer has not been initially buffered, command ignored");if(t instanceof Array)t=new Float32Array(t);else if(!s.isTypedArray(t))return void console.error("VertexBuffer requires an Array or ArrayBuffer argument, command ignored");e=void 0!==e?e:0,i.bindBuffer(i.ARRAY_BUFFER,this.id),i.bufferSubData(i.ARRAY_BUFFER,e,t)},r.prototype.bind=function(){if(o!==this){var t,e,i=this.gl,r=this.pointers,n=h||{};o=this,h={},i.bindBuffer(i.ARRAY_BUFFER,this.id);for(e in r)r.hasOwnProperty(e)&&(t=this.pointers[e],i.vertexAttribPointer(e,t.size,i[t.type],!1,t.stride,t.offset),i.enableVertexAttribArray(e),h[e]=!0,delete n[e]);for(e in n)n.hasOwnProperty(e)&&i.disableVertexAttribArray(e)}},r.prototype.unbind=function(){if(null!==o){var t,e=this.gl,i=this.pointers;for(t in i)i.hasOwnProperty(t)&&e.disableVertexAttribArray(t);e.bindBuffer(e.ARRAY_BUFFER,null),o=null,h={}}},e.exports=r}()},{"../util/Util":39,"./VertexPackage":22,"./WebGLContext":24}],22:[function(t,e){!function(){"use strict";function t(t){var e,i,r=[];for(i=0;i<t.length;i++)e=t[i],e&&e instanceof Array&&e.length>0?r.push(e):console.error("Error parsing attribute of index "+i+", attribute discarded");return r}function i(t){return void 0!==t.x?void 0!==t.y?void 0!==t.z?void 0!==t.w?4:3:2:1:t instanceof Array?t.length:1}function r(t,e){var r,n,a,s=Number.MAX_VALUE,o=0;for(t.pointers={},a=0;a<e.length;a++)r=e[a],n=i(r[0]),s=Math.min(s,r.length),t.pointers[a]={type:"FLOAT",size:n,offset:o},o+=n;t.stride=o,t.size=s}function n(t){return t[0]instanceof Array||(t=[t]),this.set(t)}n.prototype.set=function(e){var i,n,a,s,o,h,u,d=4;for(e=t(e),r(this,e),this.data=new Float32Array(this.size*this.stride),o=0;o<e.length;o++){for(i=e[o],n=this.pointers[o],s=n.offset,h=0;h<this.size;h++)switch(a=i[h],u=s+this.stride*h,n.size){case 2:this.data[u]=void 0!==a.x?a.x:a[0],this.data[u+1]=void 0!==a.y?a.y:a[1];break;case 3:this.data[u]=void 0!==a.x?a.x:a[0],this.data[u+1]=void 0!==a.y?a.y:a[1],this.data[u+2]=void 0!==a.z?a.z:a[2];break;case 4:this.data[u]=void 0!==a.x?a.x:a[0],this.data[u+1]=void 0!==a.y?a.y:a[1],this.data[u+2]=void 0!==a.z?a.z:a[2],this.data[u+3]=void 0!==a.w?a.w:a[3];break;default:this.data[u]=void 0!==a.x?a.x:a[0]}n.stride=this.stride*d,n.offset=n.offset*d}return this},n.prototype.buffer=function(){return this.data},n.prototype.attributePointers=function(){return this.pointers},e.exports=n}()},{}],23:[function(t,e){!function(){"use strict";function i(t,e,i){var r=t.gl;e&&i?r.viewport(0,0,e,i):r.viewport(0,0,t.width,t.height)}function r(t){t=t||{},this.width=t.width||window.innerWidth,this.height=t.height||window.innerHeight,this.gl=n.get()}var n=t("./WebGLContext"),a=t("../util/Stack"),s=new a;r.prototype.resize=function(t,e){return t&&e&&(this.width=t,this.height=e,this.gl.canvas.height=e,this.gl.canvas.width=t),this},r.prototype.push=function(t,e){return s.push({viewport:this,width:t,height:e}),i(this,t,e),this},r.prototype.pop=function(){var t;return s.pop(),t=s.top(),t?i(t.viewport,t.width,t.height):i(this),this},e.exports=r}()},{"../util/Stack":38,"./WebGLContext":24}],24:[function(t,e){!function(){"use strict";function t(t){return t instanceof HTMLImageElement||t instanceof HTMLCanvasElement?t:"string"==typeof t?document.getElementById(t):null}function i(t){var e,i,r=t.gl;for(i=0;i<s.length;i++)e=s[i],t.extensions[e]=r.getExtension(e),console.log(t.extensions[e]?e+" extension loaded successfully":e+" extension not supported")}function r(t){var e,r;try{r=t.getContext("webgl")||t.getContext("experimental-webgl"),e={id:t.id,gl:r,extensions:{}},i(e),a[t.id]=e,n||(n=e)}catch(s){console.error(s.message)}return r||alert("Unable to initialize WebGL. Your browser may not support it."),e}var n=null,a={},s=["OES_texture_float","OES_texture_half_float","WEBGL_lose_context","OES_standard_derivatives","OES_vertex_array_object","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_compressed_texture_s3tc","WEBGL_depth_texture","OES_element_index_uint","EXT_texture_filter_anisotropic","WEBGL_draw_buffers","ANGLE_instanced_arrays","OES_texture_float_linear","OES_texture_half_float_linear","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_pvrtc","EXT_color_buffer_half_float","WEBGL_color_buffer_float","EXT_frag_depth","EXT_sRGB","WEBGL_compressed_texture_etc1","EXT_blend_minmax","EXT_shader_texture_lod"];e.exports={bind:function(e){var i=t(e);return i?a[i.id]?(n=a[i.id],this):void console.error("No context exists for provided argument '"+e+"', command ignored."):(console.error("Context could not be bound for argument of type '"+typeof e+"', command ignored."),this)},get:function(e){if(!e)return n?n.gl:(console.error("No context is currently bound or provided, returning 'null'."),null);var i=t(e);return i&&(a[i.id]||r(i))?a[i.id].gl:(console.error("Context could not be found or created for argument of type'"+typeof e+"', returning 'null'."),null)},checkExtension:function(e,i){var r,s,o;return i?(o=t(e),o&&(s=a[o.id])):(i=e,s=n),s?(r=s.extensions,r[i]?r[i]:!1):(console.error("No context is currently bound or provided as argument, returning false."),!1)}}}()},{}],25:[function(t,e){!function(){"use strict";function t(t){return this.targets=t.targets,this}e.exports=t}()},{}],26:[function(t,e){!function(){"use strict";function i(t){var e;if(t=t||{},n.call(this,t),t.id&&(this.id=t.id),this.projectionMatrix(t.projection?t.projection:{fov:45,aspect:4/3,minZ:.1,maxZ:1e3}),this.parent=t.parent||null,this.children=[],t.children)for(e=0;e<t.children.length;e++)this.addChild(t.children[e]);return this}var r=t("alfador"),n=r.Transform,a=r.Mat44,s=t("./Entity");i.prototype=Object.create(s.prototype),i.prototype.projectionMatrix=function(t){return t?(this.projection=t instanceof Array?new a(t):t instanceof a?t:a.perspective(t.fov||45,t.aspect||4/3,t.zMin||.1,t.zMax||1e3),this):this.projection},i.prototype.copy=function(){var t,e=new i({up:this.up(),forward:this.forward(),origin:this.origin(),projection:new a(this.projection)});for(t=0;t<this.children.length;t++)e.addChild(this.children[t].copy());return e},e.exports=i}()},{"./Entity":27,alfador:10}],27:[function(t,e){!function(){"use strict";function i(t){var e,i;if(t=t||{},r.call(this,t),t.id&&(this.id=t.id),this.parent=t.parent||null,this.children=[],t.children)for(i=0;i<t.children.length;i++)this.addChild(t.children[i]);if(this.meshes=[],t.meshes)for(i=0;i<t.meshes.length;i++)this.meshes.push(t.meshes[i]instanceof n?t.meshes[i]:new n(t.meshes[i]));if(this.skeleton=null,t.skeleton&&(this.skeleton=t.skeleton instanceof a?t.skeleton:new a(t.meshes[i])),this.animations={},t.animations)for(e in t.animations)t.animations.hasOwnProperty(e)&&(this.animations[e]=t.animations[e]instanceof s?t.animations:new s(t.animations));return this}var r=t("alfador").Transform,n=t("./Mesh"),a=t("./Skeleton"),s=t("./Animation");i.prototype=Object.create(r.prototype),i.prototype.globalMatrix=function(){return this.parent?this.parent.globalMatrix().mult(this.matrix()):this.matrix()},i.prototype.globalViewMatrix=function(){return this.parent?this.parent.mult(this.matrix()).viewMatrix():this.viewMatrix()},i.prototype.addChild=function(t){return t instanceof i||(t=new i(t)),t.parent=this,this.children.push(t),this},i.prototype.removeChild=function(t){var e=this.children.indexOf(t);return-1!==e&&(this.children.splice(e,1),t.parent=null),this},i.prototype.forEach=function(t){var e,i;for(t(this),i=0;i<this.children.length;i++)e=this.children[i],e.forEach&&e.forEach(t)},i.prototype.copy=function(){var t,e=new i({up:this.up(),forward:this.forward(),origin:this.origin(),scale:this.scale(),meshes:this.meshes,skeleton:this.skeleton,animations:this.animations});for(t=0;t<this.children.length;t++)e.addChild(this.children[t].copy());return e},e.exports=i}()},{"./Animation":25,"./Mesh":31,"./Skeleton":37,alfador:10}],28:[function(t,e){!function(){"use strict";function t(t){this.positions=t.positions,this.uvs=t.uvs,this.normals=t.normals,this.tangents=t.tangents,this.bitangents=t.bitangents,this.indices=t.indices}e.exports=t}()},{}],29:[function(t,e){!function(){"use strict";function t(t){return this.id=t.id,this.name=t.name,this.bindMatrix=t.bindMatrix,this.inverseBindMatrix=t.inverseBindMatrix,this.parent=t.parent,this.children=t.children,this.index=t.index,this}t.prototype.skinningMatrix=function(t,e){return e=e||this.bindMatrix,this.globalMatrix=this.parent?this.parent.globalMatrix.mult(e):e,this.globalMatrix.mult(this.inverseBindMatrix.mult(t))},e.exports=t}()},{}],30:[function(t,e){!function(){"use strict";function i(t){return t?t instanceof a?t:new a({image:t}):null}function r(t){return t instanceof Array?[t[0],t[1],t[2],t[3]||1]:t}function n(t){return t=t||{},this.id=t.id,this.diffuseColor=r(t.diffuseColor)||[1,0,1,1],this.diffuseTexture=i(t.diffuseTexture)||null,this.ambientColor=r(t.ambientColor)||[0,0,0,1],this.ambientTexture=i(t.ambientTexture)||null,this.specularColor=r(t.specularColor)||[1,1,1,1],this.specularTexture=i(t.specularTexture)||null,this.specularComponent=t.specularComponent||10,this.reflection=void 0!==t.reflection?t.reflection:0,this.refraction=void 0!==t.refraction?t.refraction:0,this}var a=t("../core/Texture2D");e.exports=n}()},{"../core/Texture2D":19}],31:[function(t,e){!function(){"use strict";function i(t){t=t||{},this.geometry=t.geometry?t.geometry instanceof r?t.geometry:new r(t.geometry):new r(t),this.renderable=t.renderable?t.renderable instanceof n?t.renderable:new n(t.renderable):new n(t),this.material=t.material?t.material instanceof a?t.material:new a(t.material):new a(t)
}var r=t("./Geometry"),n=t("./Renderable"),a=t("./Material");i.prototype.draw=function(){return this.renderable.draw(),this},e.exports=i}()},{"./Geometry":28,"./Material":30,"./Renderable":35}],32:[function(t,e){!function(){"use strict";function i(t){var e,i,r,n,a,s=x,o=g;for(a=0;a<t.length;a++)e=t[a],i=e.a,r=e.b,n=e.c,s.x=Math.min(s.x,Math.min(Math.min(i.x,r.x),n.x)),s.y=Math.min(s.y,Math.min(Math.min(i.y,r.y),n.y)),s.z=Math.min(s.z,Math.min(Math.min(i.z,r.z),n.z)),o.x=Math.max(o.x,Math.max(Math.max(i.x,r.x),n.x)),o.y=Math.max(o.y,Math.max(Math.max(i.y,r.y),n.y)),o.z=Math.max(o.z,Math.max(Math.max(i.z,r.z),n.z));return{min:s,max:o}}function r(t,e,i){var r,n=new l(0,0,0);t.children[e]?t.children[e].insert(i):t.depth>0&&(r=t.halfWidth/2,n.x=1&e?r:-r,n.y=2&e?r:-r,n.z=4&e?r:-r,t.children[e]=new u(null,{center:t.center.add(n),halfWidth:r,depth:t.depth-1}),t.children[e].insert(i))}function n(t,e,i){var r,n,a=new l(t.center),s=t.halfWidth/2,o=0;return a.x+=1&i?s:-s,a.y+=2&i?s:-s,a.z+=4&i?s:-s,r=new l(a.x-s,a.y-s,a.z-s),n=new l(a.x+s,a.y+s,a.z+s),e.x<r.x&&(o+=(r.x-e.x)*(r.x-e.x)),e.x>n.x&&(o+=(e.x-n.x)*(e.x-n.x)),e.y<r.y&&(o+=(r.y-e.y)*(r.y-e.y)),e.y>n.y&&(o+=(e.y-n.y)*(e.y-n.y)),e.z<r.z&&(o+=(r.z-e.z)*(r.z-e.z)),e.z>n.z&&(o+=(e.z-n.z)*(e.z-n.z)),o}function a(t,e,i,r){var a=n(t,e,r);return i*i>=a}function s(){if(!d){var t=[[-1,-1,1],[1,-1,1],[1,1,1],[-1,1,1],[-1,-1,-1],[1,-1,-1],[1,1,-1],[-1,1,-1]],e=[0,1,1,2,2,3,3,0,0,4,1,5,2,6,3,7,4,5,5,6,6,7,7,4];d=new y({positions:t,indices:e,options:{mode:"LINES"}})}return d}function o(t){var e,i,r=[],n=0;for(e=new p({meshes:[s()],origin:t.center,scale:t.halfWidth}),i=0;8>i;i++)t.children[i]&&(r=r.concat(o(t.children[i])),n++);return(t.contained.length>0||n>0)&&r.push(new p({meshes:[s()],origin:t.center,scale:t.halfWidth})),r}function h(t){var e;for(e=0;e<t.length;e++)t[e]instanceof c||(t[e]=new c(t[e].positions));return t}function u(t,e){return e=e||{},t?this.build(t,e.depth||m):(this.center=e.center,this.halfWidth=e.halfWidth,this.depth=e.depth,this.clear()),this}var d,f=t("alfador"),c=f.Triangle,l=f.Vec3,p=t("./Entity"),y=t("./Mesh"),m=4,g=new l(Number.MIN_VALUE,Number.MIN_VALUE,Number.MIN_VALUE),x=new l(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);u.prototype.build=function(t,e){var r,n,a,s,o,u;for(t=h(t),r=i(t),this.clear(),this.center=r.min.add(r.max).div(2),this.depth=e||m,n=r.min.sub(this.center),a=r.max.sub(this.center),s=Math.max(Math.abs(n.x),Math.max(Math.abs(n.y),Math.abs(n.z))),o=Math.max(Math.abs(a.x),Math.max(Math.abs(a.y),Math.abs(a.z))),this.halfWidth=Math.max(s,o),u=0;u<t.length;u++)this.insert(t[u])},u.prototype.clear=function(){this.entity=null,this.contained=[],this.children=[null,null,null,null,null,null,null,null]},u.prototype.insert=function(t){var e,i=t.centroid(),n=t.radius(),s=i.x-this.center.x,o=i.y-this.center.y,h=i.z-this.center.z;if(0===this.depth&&this.contained.push(t),Math.abs(s)<n||Math.abs(o)<n||Math.abs(h)<n)for(e=0;8>e;e++)a(this,i,n,e)&&r(this,e,t);else e=0,s>0&&(e+=1),o>0&&(e+=2),h>0&&(e+=4),r(this,e,t)},u.prototype.getEntity=function(){return this.entity||(this.entity=new p({children:o(this)})),this.entity},e.exports=u}()},{"./Entity":27,"./Mesh":31,alfador:10}],33:[function(t,e){!function(){"use strict";function t(e,i,r){i&&i(e),r&&e.meshes.forEach(function(t){r(t,e)}),e.children.forEach(function(e){t(e,i,r)})}function i(t){return"object"==typeof t?(this.before=t.before||null,this.forEachEntity=t.forEachEntity||null,this.forEachMesh=t.forEachMesh||null,this.after=t.after||null):"function"==typeof t&&(this.before=t),this}i.prototype.execute=function(e,i){var r=this.before,n=this.forEachEntity,a=this.forEachMesh,s=this.after;r&&r(e),i.forEach(function(e){e&&t(e,n,a)}),s&&s()},e.exports=i}()},{}],34:[function(t,e){!function(){"use strict";function t(t){return this.id=t.id,this.passes=t.passes||[],this}t.prototype.execute=function(t,e){this.passes.forEach(function(i){i.execute(t,e)})},e.exports=t}()},{}],35:[function(t,e){!function(){"use strict";function i(t){var e=[];return t.positions&&e.push(t.positions),t.normals&&e.push(t.normals),t.uvs&&e.push(t.uvs),t.tangents&&e.push(t.tangents),t.bitangents&&e.push(t.bitangents),t.colors&&e.push(t.colors),t.joints&&e.push(t.joints),t.weights&&e.push(t.weights),e}function r(t){var e,i=new Array(t);for(e=0;t>e;e++)i[e]=e;return i}function n(t){if(t=t||{},t.vertexBuffer||t.vertexBuffers)this.vertexBuffers=t.vertexBuffers||[t.vertexBuffer];else{var e=new a(i(t));this.vertexBuffers=[new s(e)]}return this.indexBuffer=t.indexBuffer?t.indexBuffer:new o(t.indices||r(this.vertexPackage),t.options),this}var a=t("../core/VertexPackage"),s=t("../core/VertexBuffer"),o=t("../core/IndexBuffer");n.prototype.draw=function(){var t,e=this.vertexBuffers;for(t=0;t<e.length;t++)e[t].bind();return this.indexBuffer.bind(),this.indexBuffer.draw(),this},e.exports=n}()},{"../core/IndexBuffer":15,"../core/VertexBuffer":21,"../core/VertexPackage":22}],36:[function(t,e){!function(){"use strict";function t(t){return t instanceof Array||(t=[t]),this.techniques=t||[],this}t.prototype.render=function(t,e){this.techniques.forEach(function(i){var r=e[i.id];r&&r.length>0&&i.execute(t,r)})},e.exports=t}()},{}],37:[function(t,e){!function(){"use strict";function i(t,e){var r,n=e.length;for(r=0;r<e.length;r++)t[e[r].id]=e[r],n+=i(t,e[r].children);return n}function r(t){return this.root=t.root instanceof Array?t.root:[t.root],this.bindShapeMatrix=t.bindShapeMatrix||n.identity(),this.jointsById={},this.jointCount=i(this.jointsById,this.root),this}var n=t("alfador").Mat44;r.prototype.toFloat32Array=function(){var t,e,i,r,n=this.bindShapeMatrix,a=this.jointsById;t=new Float32Array(new ArrayBuffer(64*this.jointCount));for(r in a)a.hasOwnProperty(r)&&(i=a[r],e=i.skinningMatrix(n),t.set(e.data,16*i.index));return t},e.exports=r}()},{alfador:10}],38:[function(t,e){!function(){"use strict";function t(){this.data=[]}t.prototype.push=function(t){return this.data.push(t),this},t.prototype.pop=function(){return this.data.pop(),this},t.prototype.top=function(){var t=this.data.length-1;return 0>t?null:this.data[t]},e.exports=t}()},{}],39:[function(t,e){!function(){"use strict";function i(t){return function(e){t.resolve(e)}}function r(t,e){var r,n,a=[];for(n=0;n<t.length;n++)r=new s,a.push(r),t[n](i(r));o.apply(o,a).then(function(){var t=Array.prototype.slice.call(arguments,0);e(t)})}function n(t,e){var r,n,a=[],h=[];for(n in t)t.hasOwnProperty(n)&&(r=new s,h.push(r),a.push(n),t[n](i(r)));o.apply(o,h).done(function(){var t,i=Array.prototype.slice.call(arguments,0),r={};for(t=0;t<a.length;t++)r[a[t]]=i[t];e(r)})}var a=t("simply-deferred"),s=a.Deferred,o=a.when;e.exports={async:function(t,e){t instanceof Array?r(t,e):n(t,e)},extend:function(t,e){var i;for(i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},copy:function(t){return JSON.parse(JSON.stringify(t))},isEmpty:function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},isTypedArray:function(t){return t&&t.buffer instanceof ArrayBuffer&&void 0!==t.byteLength},isPowerOfTwo:function(t){return 0!==t?0===(t&t-1):!1},nextHighestPowerOfTwo:function(t){var e;for(0!==t&&(t-=1),e=1;32>e;e<<=1)t|=t>>e;return t+1}}}()},{"simply-deferred":13}],40:[function(t,e){!function(){"use strict";e.exports={load:function(t,e){var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType=e.responseType,i.addEventListener("load",function(){e.success&&e.success(this.response)}),e.progress&&i.addEventListener("progress",function(t){e.progress(t)}),e.error&&i.addEventListener("error",function(t){e.error(t)}),i.send()}}}()},{}],41:[function(t,e){!function(){"use strict";function i(t){var e=t.toString();return e=e.substr("function ".length),e=e.substr(0,e.indexOf("("))}function r(t,e){t.$$DEBUG_UUID=t.$$DEBUG_UUID||D++;var r=t.$$DEBUG_UUID+"-"+i(e);return V[r]||(V[r]=e(t)),V[r]}function n(t){var e,i,r=new Array(t.length);for(i=0;i<t.length;i++)e=t[i],r[i]=[((e.x||e[0])+1)/2,((e.y||e[1])+1)/2,((e.z||e[2]||0)+1)/2];return r}function a(t){var e=t.copy();return e.forEach(function(t){var e,i,r,n,a,s,o,h,u,d,f,c=t.meshes;for(t.meshes=[],d=0;d<c.length;d++){for(e=c[d].geometry,i=e.positions,n=e.indices,a=new Array(2*n.length),s=new Array(2*n.length),f=0;f<n.length;f+=3)o=n[f],h=n[f+1],u=n[f+2],a[2*f]=i[o],a[2*f+1]=i[h],a[2*f+2]=i[h],a[2*f+3]=i[u],a[2*f+4]=i[u],a[2*f+5]=i[o],s[2*f]=2*f,s[2*f+1]=2*f+1,s[2*f+2]=2*f+2,s[2*f+3]=2*f+3,s[2*f+4]=2*f+4,s[2*f+5]=2*f+5;t.meshes.push(new I({positions:a,indices:s,options:{mode:"LINES"},material:r}))}t.$$DEBUG_USE_COLOR=!1}),e}function s(t,e){var i=t.copy();return i.forEach(function(t){var i,r,a=t.meshes;for(t.meshes=[],r=0;r<a.length;r++)i=a[r].geometry,t.meshes.push(new I({positions:i.positions,colors:n(i[e]),indices:i.indices}));t.$$DEBUG_USE_COLOR=!0}),i}function o(t){return s(t,"uvs")}function h(t){return s(t,"normals")}function u(t){return s(t,"tangents")}function d(t){return s(t,"bitangents")}function f(t,e){var i=t.copy();return i.forEach(function(t){var i,r,n,a,s,o,h,u,d=t.meshes;for(t.meshes=[],h=0;h<d.length;h++){for(n=d[h].geometry.positions,i=d[h].geometry[e],s=new Array(2*n.length),o=new Array(2*n.length),u=0;u<n.length;u++)a=n[u],r=i[u],s[2*u]=a,s[2*u+1]=[(a.x||a[0]||0)+(r.x||r[0]||0),(a.y||a[1]||0)+(r.y||r[1]||0),(a.z||a[2]||0)+(r.z||r[2]||0)],o[2*u]=2*u,o[2*u+1]=2*u+1;t.meshes.push(new I({positions:s,indices:o,options:{mode:"LINES"}})),t.$$DEBUG_USE_COLOR=!1}}),i}function c(t){return f(t,"uvs")}function l(t){return f(t,"normals")}function p(t){return f(t,"tangents")}function y(t){return f(t,"bitangents")}var m="uProjectionMatrix",g="uModelMatrix",x="uViewMatrix",v="aPosition",w="aTexCoord",b="uUseAttribColor",_="aColor",E="uColor",T="uDiffuseSampler",M=["attribute highp vec3 "+v+";","attribute highp vec3 "+_+";","uniform highp mat4 "+g+";","uniform highp mat4 "+x+";","uniform highp mat4 "+m+";","uniform bool "+b+";","uniform highp vec3 "+E+";","varying highp vec3 vColor;","void main() {","if ( "+b+" ) {","vColor = "+_+";","} else {","vColor = "+E+";","}","gl_Position = "+m+" * "+x+" * "+g+" * vec4( "+v+", 1.0 );","}"].join("\n"),A=["varying highp vec3 vColor;","void main() {","gl_FragColor = vec4( vColor, 1.0 );","}"].join("\n"),z=["attribute highp vec3 "+v+";","attribute highp vec2 "+w+";","uniform highp mat4 "+g+";","varying highp vec2 vTexCoord;","void main() {","gl_Position = "+g+" * vec4( "+v+", 1.0 );","vTexCoord = "+w+";","}"].join("\n"),R=["varying highp vec3 vColor;","uniform sampler2D "+T+";","varying highp vec2 vTexCoord;","void main() {","gl_FragColor = texture2D( "+T+", vTexCoord );","}"].join("\n"),U=null,S=null,C=t("../../core/Shader"),I=t("../../render/Mesh"),L=t("../../render/Entity"),N=t("../../render/Renderer"),O=t("../../render/RenderTechnique"),P=t("../../render/RenderPass"),B=t("../shapes/Quad"),D=1,V={},F=null,G=!1,k=[1,1,0],j=new P({before:function(t){U||(U=new C({vert:M,frag:A})),U.push(),U.setUniform(m,t.projectionMatrix()),U.setUniform(x,t.globalViewMatrix())},forEachEntity:function(t){G=t.$$DEBUG_USE_COLOR,U.setUniform(g,t.globalMatrix())},forEachMesh:function(t){U.setUniform(b,G),U.setUniform(E,k),t.draw()},after:function(){U.pop()}}),W=new P({before:function(){S||(S=new C({vert:z,frag:R})),S.gl.disable(S.gl.DEPTH_TEST),S.push(),S.setUniform(T,0)},forEachEntity:function(t){S.setUniform(g,t.globalMatrix())},forEachMesh:function(t){t.material.diffuseTexture.push(0),t.draw(),t.material.diffuseTexture.pop(0)},after:function(){S.gl.enable(S.gl.DEPTH_TEST),S.pop()}}),X=new O({id:"debug",passes:[j]}),q=new O({id:"tex",passes:[W]}),H=new N([X,q]);e.exports={setCamera:function(t){F=t},drawTexture:function(t){var e={positions:B.positions(),uvs:B.uvs(),indices:B.indices()},i=new L({meshes:[new I({renderable:e,geomertry:e,material:{diffuseTexture:t}})],origin:[-.75,.75,0],scale:.5});H.render(null,{tex:[i]})},drawWireFrame:function(t){H.render(F,{debug:[r(t,a)]})},drawUVsAsColor:function(t){H.render(F,{debug:[r(t,o)]})},drawUVsAsVectors:function(t,e){k=e,H.render(F,{debug:[r(t,c)]})},drawNormalsAsColor:function(t){H.render(F,{debug:[r(t,h)]})},drawNormalsAsVectors:function(t,e){k=e,H.render(F,{debug:[r(t,l)]})},drawTangentsAsColor:function(t){H.render(F,{debug:[r(t,u)]})},drawTangentsAsVectors:function(t,e){k=e,H.render(F,{debug:[r(t,p)]})},drawBiTangentsAsColor:function(t){H.render(F,{debug:[r(t,d)]})},drawBiTangentsAsVectors:function(t,e){k=e,H.render(F,{debug:[r(t,y)]})}}}()},{"../../core/Shader":17,"../../render/Entity":27,"../../render/Mesh":31,"../../render/RenderPass":33,"../../render/RenderTechnique":34,"../../render/Renderer":36,"../shapes/Quad":54}],42:[function(t,e){!function(){"use strict";function i(t,e,i,r,n){if(!t[r]){var a,s,o,h=e.accessors[r],l=e.bufferViews[h.bufferView],p=n[l.buffer],y=d[h.componentType],m=f[h.type],g=c[h.type],x=h.count*m,v=new y(p,l.byteOffset+h.byteOffset,x),w=[];if(g===Number)w=v;else if("rotation"===i)for(o=0;o<h.count;o++)a=o*m,s=a+m,w.push({axis:new u(v.subarray(a,s-1)),angle:v.subarray(s-1,s)[0]});else for(o=0;o<h.count;o++)a=o*m,s=a+m,w.push(new g(v.subarray(a,s)));t[r]=w}}function r(t,e,r,n,a){var s,o,h,u,d,f,c=n.parameters;for(f=0;f<n.channels.length;f++)s=n.channels[f],o=s.target,h=n.samplers[s.sampler],u=c[h.input],d=c[h.output],i(e,r,h.input,u,a),i(e,r,h.output,d,a),t[o.id]=t[o.id]||[],t[o.id].push({path:o.path,input:e[u],output:e[d]})}var n=t("alfador"),a=n.Quaternion,s=n.Mat33,o=n.Mat44,h=n.Vec2,u=n.Vec3,d={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5126:Float32Array},f={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},c={SCALAR:Number,VEC2:h,VEC3:u,VEC4:a,MAT3:s,MAT4:o};e.exports={createAnimations:function(t,e){var i,n={},a={};for(i in t.animations)t.animations.hasOwnProperty(i)&&r(n,a,t,t.animations[i],e);return n}}}()},{alfador:10}],43:[function(t,e){!function(){"use strict";function i(t,e,r,n){var a,o,u,d=t.nodes[n],c=[],p=[],y=null,m=null;if(d.jointName||d.camera||d.light)return null;for(a=s.getNodeMatrix(d).decompose(),u=0;u<d.children.length;u++)o=i(t,e,r,d.children[u]),o&&p.push(o);if(d.meshes)for(u=0;u<d.meshes.length;u++)c=c.concat(e[d.meshes[u]]);if(d.instanceSkin){for(y=f.createSkeleton(t,d.instanceSkin,r),u=0;u<d.instanceSkin.meshes.length;u++)c=c.concat(e[d.instanceSkin.meshes[u]]);m=h.createAnimations(t,r)}return new l({id:n,up:a.up,forward:a.forward,left:a.left,origin:a.origin,scale:a.scale,children:p,meshes:c,skeleton:y,animations:m})}function r(t,e,r){var n,a,s=t.scenes[t.scene].nodes,o=[];for(a=0;a<s.length;a++)n=i(t,e,r,s[a]),n&&o.push(n);return o}function n(t,e){c.async({buffers:function(e){s.requestBuffers(t.buffers,function(t){e(t)})},materials:function(e){o.loadMaterials(t,function(t){e(t)})}},function(i){var n=u.createMeshes(t,i.buffers,i.materials);e(r(t,n,i.buffers))})}var a=t("path"),s=t("./glTFUtil"),o=t("./glTFMaterial"),h=t("./glTFAnimation"),u=t("./glTFMesh"),d=t("./glTFParser"),f=t("./glTFSkeleton"),c=t("../Util"),l=t("../../render/Entity");e.exports={load:function(t,e){var i=a.basename(t,a.extname(t)),r=Object.create(d,{handleLoadCompleted:{value:function(){n(this.json,function(t){var r=new l({id:i,children:t});e(r)})}}});r.initWithPath(t),r.load(null,null)}}}()},{"../../render/Entity":27,"../Util":39,"./glTFAnimation":42,"./glTFMaterial":44,"./glTFMesh":45,"./glTFParser":46,"./glTFSkeleton":47,"./glTFUtil":48,path:11}],44:[function(t,e){!function(){"use strict";function i(t,e,i,r){var n=i[e];n&&("SAMPLER_2D"===p[n.type]?t[e+"Texture"]=r[n.value]:t[e+"Color"]=n.value)}function r(t,e,r){var n={id:t};return i(n,"ambient",e,r),i(n,"diffuse",e,r),i(n,"specular",e,r),e.shininess&&(n.specularComponent=e.shininess.value),new d(n)}function n(t,e){var i,r=o.copy(t.parameters),n=o.copy(e.values);for(i in n)n.hasOwnProperty(i)&&(r[i].value=n[i]);return r}function a(t,e){var i,a,s,o=t.materials,h=t.techniques,u={};for(s in o)o.hasOwnProperty(s)&&(i=o[s].instanceTechnique,a=n(h[i.technique],i),u[s]=r(s,a,e));return u}function s(t,e){var i,r,n=t.textures,a={};for(r in n)n.hasOwnProperty(r)&&(i=n[r],a[r]=new u({image:e[i.source],format:f[i.format]||f["default"],internalFormat:c[i.internalFormat]||c["default"],type:l[i.type]||l["default"],wrap:"REPEAT"}));return a}var o=t("../Util"),h=t("./glTFUtil"),u=t("../../core/Texture2D"),d=t("../../render/Material"),f={6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA","default":"RGBA"},c={6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA","default":"RGBA"},l={5121:"UNSIGNED_BYTE",33635:"UNSIGNED_SHORT_5_6_5",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1","default":"UNSIGNED_BYTE"},p={5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D"};e.exports={loadMaterials:function(t,e){h.requestImages(t.images,function(i){var r=s(t,i),n=a(t,r);e(n)})}}}()},{"../../core/Texture2D":19,"../../render/Material":30,"../Util":39,"./glTFUtil":48}],45:[function(t,e){!function(){"use strict";function i(t,e,i,r){if(!e)return null;var n=h.get(),a=i.accessors[e],s=a.bufferView,o=i.bufferViews[s],u=c[o.target],f=a.count*p[a.type],y=l[a.componentType];return t[s]||(t[s]=n.createBuffer(),u=c[o.target],n.bindBuffer(n[u],t[s]),n.bufferData(n[u],o.byteLength,n.STATIC_DRAW)),n.bufferSubData(n[u],a.byteOffset,new y(r[o.buffer],o.byteOffset+a.byteOffset,f)),{bufferView:s,size:p[a.type],type:d[a.componentType],stride:a.byteStride,offset:a.byteOffset,count:a.count}}function r(t,e,i){i&&(t[i.bufferView]=t[i.bufferView]||{},t[i.bufferView][e]=i)}function n(t,e,n,a,h){var d,c,l,p,y,m,g,x,v,w,b=e.attributes,_=e.indices,E=e.material,T={},M=[];c=i(t,b.POSITION||b.POSITION_0,n,a),l=i(t,b.NORMAL||b.NORMAL_0,n,a),p=i(t,b.TEXCOORD||b.TEXCOORD_0,n,a),m=i(t,b.JOINT||b.JOINT_0,n,a),g=i(t,b.WEIGHT||b.WEIGHT_0,n,a),y=i(t,b.COLOR||b.COLOR_0,n,a),r(T,"0",c),r(T,"1",l),r(T,"2",p),r(T,"3",m),r(T,"4",g);for(w in T)T.hasOwnProperty(w)&&(v=T[w],M.push(new s(t[w],v)));return x=i(t,_,n,a),x.mode=f[e.primitive]||f["default"],d=new o(t[x.bufferView],x),new u({vertexBuffers:M,indexBuffer:d,material:h[E]})}function a(t,e,i,r,a){var s,o=e.primitives,h=[];for(s=0;s<o.length;s++)h.push(n(t,o[s],i,r,a));return h}var s=t("../../core/VertexBuffer"),o=t("../../core/IndexBuffer"),h=t("../../core/WebGLContext"),u=t("../../render/Mesh"),d={5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5126:"FLOAT"},f={0:"POINTS",1:"LINES",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN","default":"TRIANGLES"},c={34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER"},l={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5126:Float32Array},p={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};e.exports={createMeshes:function(t,e,i){var r,n=t.meshes,s={},o={};for(r in t.meshes)t.meshes.hasOwnProperty(r)&&(o[r]=a(s,n[r],t,e,i));return o}}}()},{"../../core/IndexBuffer":15,"../../core/VertexBuffer":21,"../../core/WebGLContext":24,"../../render/Mesh":31}],46:[function(t,e){!function(){"use strict";var t=["buffers","bufferViews","images","videos","samplers","textures","shaders","programs","techniques","materials","accessors","meshes","cameras","lights","skins","nodes","scenes","animations"],i=Object.create(Object.prototype,{_rootDescription:{value:null,writable:!0},rootDescription:{set:function(t){this._rootDescription=t},get:function(){return this._rootDescription}},baseURL:{value:null,writable:!0},_isAbsolutePath:{value:function(t){var e=new RegExp("^"+window.location.protocol,"i");return t.match(e)?!0:!1}},resolvePathIfNeeded:{value:function(t){return this._isAbsolutePath(t)?t:this.baseURL+t}},_resolvePathsForCategories:{value:function(t){t.forEach(function(t){var e=this.json[t];if(e){var i=Object.keys(e);i.forEach(function(t){var i=e[t];i.path=this.resolvePathIfNeeded(i.path||i.uri)},this)}},this)}},_json:{value:null,writable:!0},json:{enumerable:!0,get:function(){return this._json},set:function(t){this._json!==t&&(this._json=t,this._resolvePathsForCategories(["buffers","shaders","images","videos"]))}},_path:{value:null,writable:!0},getEntryDescription:{value:function(t,e){var i=null,r=e;return i=this.rootDescription[r],i?i?i[t]:null:(console.log("ERROR:CANNOT find expected category named:"+r),null)}},_stepToNextCategory:{value:function(){return this._state.categoryIndex=this.getNextCategoryIndex(this._state.categoryIndex+1),-1!==this._state.categoryIndex?(this._state.categoryState.index=0,!0):!1}},_stepToNextDescription:{enumerable:!1,value:function(){var t=this._state.categoryState,e=t.keys;return e?(t.index++,t.keys=null,t.index>=e.length?this._stepToNextCategory():!1):(console.log("INCONSISTENCY ERROR"),!1)}},hasCategory:{value:function(t){return this.rootDescription[t]?!0:!1}},_handleState:{value:function(){for(var e={buffers:this.handleBuffer,bufferViews:this.handleBufferView,shaders:this.handleShader,programs:this.handleProgram,techniques:this.handleTechnique,materials:this.handleMaterial,meshes:this.handleMesh,cameras:this.handleCamera,lights:this.handleLight,nodes:this.handleNode,scenes:this.handleScene,images:this.handleImage,animations:this.handleAnimation,accessors:this.handleAccessor,skins:this.handleSkin,samplers:this.handleSampler,textures:this.handleTexture,videos:this.handleVideo},i=!0;-1!==this._state.categoryIndex;){var r=t[this._state.categoryIndex],n=this._state.categoryState,a=n.keys;if(a||(n.keys=a=Object.keys(this.rootDescription[r]),!a||0!==a.length)){var s=r,o=a[n.index],h=this.getEntryDescription(o,s);if(h){if(e[s]&&e[s].call(this,o,h,this._state.userInfo)===!1){i=!1;break}this._stepToNextDescription()}else if(this.handleError){this.handleError("INCONSISTENCY ERROR: no description found for entry "+o),i=!1;break}}else this._stepToNextDescription()}this.handleLoadCompleted&&this.handleLoadCompleted(i)}},_loadJSONIfNeeded:{enumerable:!0,value:function(t){var e=this;if(this._json)t&&t(this.json);else{var i=this._path,r=i.lastIndexOf("/");this.baseURL=0!==r?i.substring(0,r+1):"";var n=new XMLHttpRequest;n.open("GET",i,!0),n.addEventListener("load",function(){e.json=JSON.parse(n.responseText),t&&t(e.json)},!1),n.send(null)}}},_buildLoader:{value:function(t){function e(e){i.rootDescription=e,t&&t(this)}var i=this;this._loadJSONIfNeeded(e)}},_state:{value:null,writable:!0},_getEntryType:{value:function(){for(var e=t,i=0;i<e.length;i++){var r=this.rootDescription[e[i]];if(r)return e[i]}return null}},getNextCategoryIndex:{value:function(e){for(var i=e;i<t.length;i++)if(this.hasCategory(t[i]))return i;return-1}},load:{enumerable:!0,value:function(t,e){var i=this;this._buildLoader(function(){var r=i.getNextCategoryIndex.call(i,0);-1!==r&&(i._state={userInfo:t,options:e,categoryIndex:r,categoryState:{index:"0"}},i._handleState())})}},initWithPath:{value:function(t){return this._path=t,this._json=null,this}},_knownURLs:{writable:!0,value:{}},loaderContext:{value:function(){return"undefined"==typeof this._knownURLs[this._path]&&(this._knownURLs[this._path]=Object.keys(this._knownURLs).length),"__"+this._knownURLs[this._path]}},initWithJSON:{value:function(t,e){return this.json=t,this.baseURL=e,e||console.log("WARNING: no base URL passed to Reader:initWithJSON"),this}}});e.exports=i}()},{}],47:[function(t,e){!function(){"use strict";function i(t,e,i){var r,n,a,s=t.accessors[e.inverseBindMatrices],o=t.bufferViews[s.bufferView],h=i[o.buffer],u=d[s.componentType],l=f[s.type],p=c[s.type],y=s.count*l,m=new u(h,o.byteOffset+s.byteOffset,y),g=[];for(a=0;a<s.count;a++)r=a*l,n=r+l,g.push(new p(m.subarray(r,n)));return g}function r(t,e,i,n,a){var s,u,d,f,c,l=t.nodes[e],p=n.jointNames.indexOf(l.jointName);if(-1===p)return null;for(s=o.getNodeMatrix(l),u=a[p],f=new h({id:e,name:l.jointName,bindMatrix:s,inverseBindMatrix:u,parent:i,children:[],index:p}),c=0;c<l.children.length;c++)d=r(t,l.children[c],f,n,a),d&&f.children.push(d);return f}var n=t("alfador"),a=n.Mat33,s=n.Mat44,o=t("./glTFUtil"),h=t("../../render/Joint"),u=t("../../render/Skeleton"),d={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5126:Float32Array},f={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},c={MAT3:a,MAT4:s};e.exports={createSkeleton:function(t,e,n){var a,o=e.skeletons,h=t.skins[e.skin],d=i(t,h,n),f=[];for(a=0;a<o.length;a++)f.push(r(t,o[a],null,h,d));return new u({root:f,bindShapeMatrix:new s(h.bindShapeMatrix||[])})}}}()},{"../../render/Joint":29,"../../render/Skeleton":37,"./glTFUtil":48,alfador:10}],48:[function(t,e){!function(){"use strict";var i=t("alfador"),r=i.Quaternion,n=i.Mat44,a=i.Vec2,s=i.Vec3,o=i.Vec4,h=t("../Util"),u=t("../XHRLoader");e.exports={convertVec4Array:function(t){var e,i=new Array(t.length/4);for(e=0;e<t.length;e+=4)i[e/4]=new o(t[e],t[e+1],t[e+2],t[e+3]);return i},convertVec3Array:function(t){var e,i=new Array(t.length/3);for(e=0;e<t.length;e+=3)i[e/3]=new s(t[e],t[e+1],t[e+2]);return i},convertVec2Array:function(t){var e,i=new Array(t.length/2);for(e=0;e<t.length;e+=2)i[e/2]=new a(t[e],t[e+1]);return i},getNodeMatrix:function(t){var e,i,a;return t.matrix?new n(t.matrix):(e=t.translation?n.translation(t.translation):n.identity(),i=t.rotation?n.rotationRadians(t.rotation[3],t.rotation):n.identity(),t.orientation&&(i=new r(t.orientation).matrix()),a=t.scale?n.scale(t.scale):n.identity(),e.mult(i).mult(a))},requestBuffers:function(t,e){function i(t){return function(e){u.load(t,{responseType:"arraybuffer",success:function(t){e(t)}})}}var r,n={};for(r in t)t.hasOwnProperty(r)&&(n[r]=i(t[r].path));h.async(n,function(t){e(t)})},requestImages:function(t,e){function i(t){return function(e){var i=new Image;i.onload=function(){e(i)},i.src=t}}var r,n={};for(r in t)t.hasOwnProperty(r)&&(n[r]=i(t[r].path));h.async(n,function(t){e(t)})}}}()},{"../Util":39,"../XHRLoader":40,alfador:10}],49:[function(t,e){!function(){"use strict";function i(t){return function(e){var i=new Image;i.onload=function(){e(i)},i.src=t}}function r(t,e){return function(r){var n,a,s={id:t.name},h={};for(a in t)if(t.hasOwnProperty(a))switch(n=t[a],a){case"kd":s.diffuseColor=n;break;case"ka":s.ambientColor=n;break;case"ks":s.specularColor=n;break;case"ns":s.specularComponent=n;break;case"map_kd":h.diffuse=i(e+"/"+n);break;case"d":1>n&&(s.alpha=n);break;case"illum":n>2&&10>n&&(s.reflection=.3),(6===n||7===n)&&(s.refraction=.8)}o.async(h,function(t){var e;for(e in t)t.hasOwnProperty(e)&&(s[e+"Texture"]=t[e]);r(s)})}}function n(t,e,i){var n,a={};for(n in t)t.hasOwnProperty(n)&&(a[n]=r(t[n],e));o.async(a,function(t){i(t)})}function a(t){var e,i,r,n,a,s,o=t.split("\n"),h={},u={};for(s=0;s<o.length;s++)i=o[s].trim(),0!==i.length&&"#"!==i.charAt(0)&&(r=i.indexOf(" "),r>=0?(n=i.substring(0,r).toLowerCase(),a=i.substring(r+1).trim()):(n=i,a=""),"newmtl"===n?(u={name:a},h[a]=u):u&&("ka"===n||"kd"===n||"ks"===n||"ke"===n?(e=a.split(/\s+/,3),u[n]=[parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2])]):u[n]="ns"===n||"d"===n?parseFloat(a):a));return h}var s=t("path"),o=t("../Util"),h=t("../XHRLoader");e.exports={load:function(t,e){var i=s.dirname(t);h.load(t,{responseType:"text",success:function(t){var r=a(t);n(r,i,e)}})}}}()},{"../Util":39,"../XHRLoader":40,path:11}],50:[function(t,e){!function(){"use strict";function i(t,e){var i=t.positions[e].toString();return t.normals&&(i+="-"+t.normals[e].toString()),t.uvs&&(i+="-"+t.uvs[e].toString()),i}function r(t){var e,r,n,a,s,o,h=[],u=[],d=[],f=[],c=0,l={};for(s=0;s<t.triangles.length;s++)for(n=t.triangles[s],o=0;3>o;o++)e=i(n,o),void 0===a?(h.push(n.positions[o]),n.normals&&u.push(n.normals[o]),n.uvs&&d.push(n.uvs[o]),f.push(c),l[e]=c,c++):f.push(a);return r={triangles:t.triangles,positions:h,indices:f,normals:u,material:t.material},d.length>0&&(r.uvs=d),r}function n(t){var e,i=t.meshes;for(e=0;e<i.length;e++)i[e]=r(i[e]);return t}function a(t){function e(t,e,i){var r;b=[],r={triangles:b},t&&(r.group=t),e&&(r.name=e),i&&(r.material=i),g.meshes.push(r),_=null,E=null}function i(t){var e=parseInt(t);return e>=0?x[e-1]:x[e+x.length]}function r(t){var e=parseInt(t);return e>=0?v[e-1]:v[e+v.length]}function n(t){var e=parseInt(t);return e>=0?w[e-1]:w[e+w.length]}function a(t,e,a){var s,o,h,u,d,f,c,l={};l.positions=[i(t[0]),i(t[1]),i(t[2])],e&&(l.uvs=[r(e[0]),r(e[1]),r(e[2])]),a?l.normals=[n(a[0]),n(a[1]),n(a[2])]:(s=l.positions[0],o=l.positions[1],h=l.positions[2],u=[o[0]-s[0],o[1]-s[1],o[2]-s[2]],d=[h[0]-s[0],h[1]-s[1],h[2]-s[2]],f=[u[1]*d[2]-d[1]*u[2],-u[0]*d[2]+d[0]*u[2],u[0]*d[1]-d[0]*u[1]],c=Math.sqrt(f[0]*f[0]+f[1]*f[1]+f[2]*f[2]),f=[f[0]/c,f[1]/c,f[2]/c],l.normals=[f,f,f]),b.push(l)}function s(t,e,i){a(t,e,i),void 0!==t[3]&&(t=[t[0],t[2],t[3]],e&&(e=[e[0],e[2],e[3]]),i&&(i=[i[0],i[2],i[3]]),a(t,e,i))}var o,h,u,d=/v( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/,f=/vn( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/,c=/vt( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/,l=/f( +-?\d+)( +-?\d+)( +-?\d+)( +-?\d+)?/,p=/f( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))?/,y=/f( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))?/,m=/f( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))?/,g={meshes:[]},x=[],v=[],w=[],b=[],_=null,E=null,T=t.split("\n");for(u=0;u<T.length;u++)o=T[u].trim(),0!==o.length&&"#"!==o.charAt(0)&&(null!==(h=d.exec(o))?x.push([parseFloat(h[1]),parseFloat(h[2]),parseFloat(h[3])]):null!==(h=f.exec(o))?w.push([parseFloat(h[1]),parseFloat(h[2]),parseFloat(h[3])]):null!==(h=c.exec(o))?v.push([parseFloat(h[1]),parseFloat(1-h[2])]):null!==(h=l.exec(o))?s([h[1],h[2],h[3],h[4]],null,null):null!==(h=p.exec(o))?s([h[2],h[5],h[8],h[11]],[h[3],h[6],h[9],h[12]],null):null!==(h=y.exec(o))?s([h[2],h[6],h[10],h[14]],[h[3],h[7],h[11],h[15]],[h[4],h[8],h[12],h[16]]):null!==(h=m.exec(o))?s([h[2],h[5],h[8],h[11]],null,[h[3],h[6],h[9],h[12]]):/^o /.test(o)?E=o.substring(2).trim():/^g /.test(o)?_=o.substring(2).trim():/^usemtl /.test(o)?e(_,E,o.substring(7).trim()):/^mtllib /.test(o)&&(g.mtllib=g.mtllib||[],g.mtllib.push(o.substring(7).trim())));return 0===g.meshes.length&&g.meshes.push({triangles:b}),g}var s=t("../XHRLoader");e.exports={load:function(t,e){s.load(t,{responseType:"text",success:function(t){var i=a(t),r=n(i);e(r)}})}}}()},{"../XHRLoader":40}],51:[function(t,e){!function(){"use strict";function i(t){return function(e){o.load(t,e)}}function r(t,e,r){var n,s=[];if(!t.mtllib)return void r(t);for(n=0;n<t.mtllib.length;n++)s.push(i(e+"/"+t.mtllib[n]));a.async(s,function(t){var e,i={};for(e=0;e<t.length;e++)a.extend(i,t[e]);r(i)})}var n=t("path"),a=t("../Util"),s=t("./OBJLoader"),o=t("./MTLLoader");e.exports={load:function(t,e){s.load(t,function(i){r(i,n.dirname(t),function(t){var r,n=i.meshes;for(r=0;r<n.length;r++)n[r].material=t[n[r].material];e(i)})})}}}()},{"../Util":39,"./MTLLoader":49,"./OBJLoader":50,path:11}],52:[function(t,e){!function(){"use strict";var t=1;e.exports={positions:function(e){return e=e||t,[[-e/2,-e/2,e/2],[e/2,-e/2,e/2],[e/2,e/2,e/2],[-e/2,e/2,e/2],[-e/2,-e/2,-e/2],[-e/2,e/2,-e/2],[e/2,e/2,-e/2],[e/2,-e/2,-e/2],[-e/2,e/2,-e/2],[-e/2,e/2,e/2],[e/2,e/2,e/2],[e/2,e/2,-e/2],[-e/2,-e/2,-e/2],[e/2,-e/2,-e/2],[e/2,-e/2,e/2],[-e/2,-e/2,e/2],[e/2,-e/2,-e/2],[e/2,e/2,-e/2],[e/2,e/2,e/2],[e/2,-e/2,e/2],[-e/2,-e/2,-e/2],[-e/2,-e/2,e/2],[-e/2,e/2,e/2],[-e/2,e/2,-e/2]]},normals:function(){return[[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,-1],[0,0,-1],[0,0,-1],[0,0,-1],[0,1,0],[0,1,0],[0,1,0],[0,1,0],[0,-1,0],[0,-1,0],[0,-1,0],[0,-1,0],[1,0,0],[1,0,0],[1,0,0],[1,0,0],[-1,0,0],[-1,0,0],[-1,0,0],[-1,0,0]]},uvs:function(){return[[0,0],[1,0],[1,1],[0,1],[1,0],[1,1],[0,1],[0,0],[0,1],[0,0],[1,0],[1,1],[1,1],[0,1],[0,0],[1,0],[1,0],[1,1],[0,1],[0,0],[0,0],[1,0],[1,1],[0,1]]},indices:function(){return[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]},geometry:function(t){return{positions:this.positions(t),normals:this.normals(),uvs:this.uvs(),indices:this.indices()}
}}}()},{}],53:[function(t,e){!function(){"use strict";var t=20,i=1,r=1;e.exports={positions:function(e,n,a){var s,o,h,u,d=[];for(e=e||t,n=n||i,a=a||r,s=2*Math.PI/e,u=0;e>=u;u++)o=a*Math.sin(u*s),h=a*Math.cos(u*s),d.push([o,n,h]);for(u=0;e>=u;u++)o=a*Math.sin(u*s),h=a*Math.cos(u*s),d.push([o,0,h]);return d},normals:function(e){var i,r,n,a,s=[];for(e=e||t,i=2*Math.PI/e,a=0;e>=a;a++)r=Math.sin(a*i),n=Math.cos(a*i),s.push([r,0,n]);for(a=0;e>=a;a++)r=Math.sin(a*i),n=Math.cos(a*i),s.push([r,0,n]);return s},uvs:function(e){var i,r=[];for(e=e||t,i=0;e>=i;i++)r.push([i/e,1]);for(i=0;e>=i;i++)r.push([i/e,0]);return r},indices:function(e){var i,r=0,n=[];for(e=e||t,i=0;e>=i;i++)n.push(r+e+1),n.push(r),n.push(r+e),n.push(r+e+1),n.push(r+1),n.push(r),r++;return n},geometry:function(t,e){return{positions:this.positions(t,e),normals:this.normals(t),uvs:this.uvs(t),indices:this.indices(t)}}}}()},{}],54:[function(t,e){!function(){"use strict";var t=1;e.exports={positions:function(e){return e=e||t,[[-e/2,-e/2,0],[e/2,-e/2,0],[e/2,e/2,0],[-e/2,e/2,0]]},normals:function(){return[[0,0,1],[0,0,1],[0,0,1],[0,0,1]]},uvs:function(){return[[0,0],[1,0],[1,1],[0,1]]},indices:function(){return[0,1,2,0,2,3]},geometry:function(t){return{positions:this.positions(t),normals:this.normals(),uvs:this.uvs(),indices:this.indices()}}}}()},{}],55:[function(t,e){!function(){"use strict";function i(t,e,i){t=new a(t);var r=t.dot(e);return e=e.sub(t.mult(r)).normalize(),t.cross(e).dot(i)<0?e.negate():e}function r(t,e,i){t[e]?t[e].add(i):t[e]=new a(i)}var n=t("alfador"),a=n.Vec3,s=n.Vec2;e.exports={computeNormals:function(t,e){var i,r,n,s,o,h,u,d,f,c,l=new Array(t.length);for(c=0;c<e.length;c+=3)r=e[c],n=e[c+1],s=e[c+2],o=new a(t[r]),h=new a(t[n]),u=new a(t[s]),d=h.sub(o),f=u.sub(o),i=d.cross(f).normalize(),l[r]=i,l[n]=i,l[s]=i;return l},computeTangents:function(t,e,n,o){var h,u,d,f,c,l,p,y,m,g,x,v,w,b,_,E,T,M,A,z,R,U,S,C,I=new Array(t.length),L=new Array(t.length);for(C=0;C<o.length;C+=3)h=o[C],u=o[C+1],d=o[C+2],c=new a(t[h]),l=new a(t[u]),p=new a(t[d]),y=new s(n[h]),m=new s(n[u]),g=new s(n[d]),x=l.sub(c),v=p.sub(c),w=m.sub(y),b=g.sub(y),f=1/(w.x*b.y-w.y*b.x),_=x.mult(b.y),E=v.mult(w.y),A=_.sub(E).mult(f),T=v.mult(w.x),M=x.mult(b.x),S=T.sub(M).mult(f),z=i(e[h],A,S),R=i(e[u],A,S),U=i(e[d],A,S),r(I,h,z),r(I,u,R),r(I,d,U),r(L,h,S),r(L,u,S),r(L,d,S);for(C=0;C<I.length;C++)I[C]=I[C].normalize(),L[C]=L[C].normalize();return{tangents:I,bitangents:L}}}}()},{alfador:10}],56:[function(t,e){!function(){"use strict";var t=20,i=20,r=1;e.exports={positions:function(e,n,a){var s,o,h,u,d,f,c,l,p=[];for(e=e||t,n=n||i,a=a||r,s=Math.PI/n,o=2*Math.PI/e,c=0;n>=c;c++)for(h=a*Math.sin(c*s),u=a*Math.cos(c*s),l=0;e>=l;l++)d=h*Math.sin(l*o),f=h*Math.cos(l*o),p.push([d,u,f]);return p},normals:function(e,r){var n,a,s,o,h,u,d,f,c=[];for(e=e||t,r=r||i,n=Math.PI/r,a=2*Math.PI/e,d=0;r>=d;d++)for(s=Math.sin(d*n),o=Math.cos(d*n),f=0;e>=f;f++)h=s*Math.sin(f*a),u=s*Math.cos(f*a),c.push([h,o,u]);return c},uvs:function(e,r){var n,a,s=[];for(e=e||t,r=r||i,n=0;r>=n;n++)for(a=0;e>=a;a++)s.push([a/e,1-n/r]);return s},indices:function(e,r){var n,a,s=0,o=[];for(e=e||t,r=r||i,n=0;r>=n;n++)for(a=0;e>=a;a++)n!==r&&(o.push(s+e+1),o.push(s),o.push(s+e),o.push(s+e+1),o.push(s+1),o.push(s),s++);return o},geometry:function(t,e,i){return{positions:this.positions(t,e,i),normals:this.normals(t,e),uvs:this.uvs(t,e),indices:this.indices(t,e)}}}}()},{}]},{},[1])(1)});